import{u as le,r as o,j as e,N as he,a as ve,R as Be,C as je,b as ye,c as Le,d as ne,O as Te,e as Ee,f as Oe,g as Pe}from"./react-A04ReXPw.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))a(y);new MutationObserver(y=>{for(const p of y)if(p.type==="childList")for(const j of p.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&a(j)}).observe(document,{childList:!0,subtree:!0});function c(y){const p={};return y.integrity&&(p.integrity=y.integrity),y.referrerPolicy&&(p.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?p.credentials="include":y.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(y){if(y.ep)return;y.ep=!0;const p=c(y);fetch(y.href,p)}})();function We(){const s=le(),[l,c]=o.useState("");o.useEffect(()=>{var j,n;try{let b=sessionStorage.getItem("bakery_app_auth");if(!b){const W=sessionStorage.getItem("bakery_user_role")||localStorage.getItem("bakery_user_role");W==="admin"?b=localStorage.getItem("bakery_app_auth_admin"):W==="cashier"&&(b=localStorage.getItem("bakery_app_auth_cashier")),b||(b=localStorage.getItem("bakery_app_auth"))}if(b){const W=JSON.parse(b);c(((j=W.user)==null?void 0:j.username)||((n=W.user)==null?void 0:n.name)||"cashie")}else c("cashie")}catch{c("cashie")}},[]);const[a,y]=o.useState(0);o.useEffect(()=>{function j(){try{const n=localStorage.getItem("bakery_app_v1");if(n){const b=JSON.parse(n);y((b.notifications||[]).length)}}catch{}}return j(),window.addEventListener("storage",j),()=>window.removeEventListener("storage",j)},[]);const p=()=>{try{sessionStorage.removeItem("bakery_app_auth"),sessionStorage.removeItem("bakery_user_role")}catch(j){console.warn("failed clearing session",j)}s("/login")};return localStorage.getItem("bakery_user_role"),e.jsx("header",{role:"banner",className:"sticky top-0 z-[1200] bg-white/90 backdrop-blur border-b border-slate-100 shadow-sm",children:e.jsxs("div",{className:"w-full px-3 h-20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"inline-flex md:hidden items-center justify-center w-9 h-9 rounded-md border border-slate-200 text-slate-700","aria-label":"Open menu",onClick:()=>window.dispatchEvent(new CustomEvent("toggleMobileSidebar")),children:"â˜°"}),e.jsxs("div",{"aria-hidden":!0,className:"flex items-baseline gap-2 select-none",children:[e.jsx("span",{className:"text-[22px] font-extrabold text-slate-900",children:"Bakery"}),e.jsx("span",{className:"text-[22px] font-extrabold bg-gradient-to-r from-orange-500 to-amber-500 bg-clip-text text-transparent",children:"Admin"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{id:"zoomControls",className:"hidden sm:flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 shadow-sm",children:[e.jsx("button",{className:"px-2 py-1 text-slate-700",onClick:()=>{const j=Number(document.documentElement.style.zoom||1)-.1;document.documentElement.style.zoom=String(Math.max(.5,Math.round(j*100)/100))},children:"âˆ’"}),e.jsx("button",{className:"px-2 py-1 font-semibold text-slate-800",onClick:()=>{document.documentElement.style.zoom="1"},children:"100%"}),e.jsx("button",{className:"px-2 py-1 text-slate-700",onClick:()=>{const j=Number(document.documentElement.style.zoom||1)+.1;document.documentElement.style.zoom=String(Math.min(2,Math.round(j*100)/100))},children:"+"})]}),e.jsxs("button",{className:"relative w-9 h-9 inline-flex items-center justify-center rounded-md text-slate-700 hover:bg-slate-100",onClick:()=>s("/admin/notifications"),"aria-label":"Notifications",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-slate-700",children:[e.jsx("path",{d:"M12 3c-3 0-5 2.5-5 5.5v3.5l-2 2v1h14v-1l-2-2V8.5C17 5.5 15 3 12 3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 19a2 2 0 0 0 4 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),a>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] px-1.5 py-[2px] rounded-full font-bold",children:a})]}),e.jsx("button",{className:"inline-flex items-center rounded-md px-3 h-9 text-white font-semibold bg-gradient-to-r from-orange-500 to-amber-500 hover:brightness-105",onClick:p,children:"Logout"})]})]})})}function Re(){const[s,l]=o.useState(!1),[c,a]=o.useState(!1),y=le();return o.useEffect(()=>{try{const p=window.matchMedia&&window.matchMedia("(max-width:720px)").matches;l(p)}catch{}},[]),o.useEffect(()=>{function p(){a(j=>!j)}return window.addEventListener("toggleMobileSidebar",p),()=>window.removeEventListener("toggleMobileSidebar",p)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:`sidebar ${s?"collapsed":""} ${c?"mobile-open":""}`,role:"navigation","aria-label":"Main sidebar",children:[e.jsxs("div",{className:"sidebar-head",children:[e.jsx("div",{className:"logo","aria-hidden":"true"}),e.jsx("button",{className:"sidebar-toggle",onClick:()=>l(p=>!p),"aria-expanded":!s,"aria-label":s?"Expand sidebar":"Collapse sidebar",children:s?"â€º":"â€¹"})]}),e.jsx("nav",{className:"nav",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs(he,{to:"/admin",end:!0,className:({isActive:p})=>`flex items-center gap-4 px-4 py-2.5 rounded-[18px] ${p?"text-white":"hover:bg-white/5"}`,"aria-label":"Dashboard",style:({isActive:p})=>p?{backgroundImage:"linear-gradient(to right, #FF9500, #FFB800)",boxShadow:"0 10px 24px rgba(255,149,0,0.28)"}:{color:"var(--sidebar-foreground)"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{color:"inherit"},children:[e.jsx("path",{d:"M3 10.5L12 3l9 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M5 9.5v10h14v-10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("span",{className:"link-label",children:"Dashboard"})]})}),e.jsx("li",{className:"divider","aria-hidden":"true"}),e.jsx("li",{children:e.jsxs(he,{to:"/admin/users",className:({isActive:p})=>`flex items-center gap-4 px-4 py-2.5 rounded-[18px] ${p?"text-white":"hover:bg-white/5"}`,"aria-label":"Users",style:({isActive:p})=>p?{backgroundImage:"linear-gradient(to right, #FF9500, #FFB800)",boxShadow:"0 10px 24px rgba(255,149,0,0.28)"}:{color:"var(--sidebar-foreground)"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{color:"inherit"},children:[e.jsx("path",{d:"M8 11a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M16 12.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M3 20c0-3.314 3.134-6 7-6s7 2.686 7 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),e.jsx("span",{className:"link-label",children:"Users"})]})}),e.jsx("li",{className:"divider","aria-hidden":"true"}),e.jsx("li",{children:e.jsxs(he,{to:"/admin/daily-summary",className:({isActive:p})=>`flex items-center gap-4 px-4 py-2.5 rounded-[18px] ${p?"text-white":"hover:bg-white/5"}`,"aria-label":"Summarry",style:({isActive:p})=>p?{backgroundImage:"linear-gradient(to right, #FF9500, #FFB800)",boxShadow:"0 10px 24px rgba(255,149,0,0.28)"}:{color:"var(--sidebar-foreground)"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{color:"inherit"},children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M8 3v4M16 3v4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M3 9h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),e.jsx("span",{className:"link-label",children:"Summarry"})]})}),e.jsx("li",{children:e.jsxs(he,{to:"/admin/notifications",className:({isActive:p})=>`flex items-center gap-4 px-4 py-2.5 rounded-[18px] ${p?"text-white":"hover:bg-white/5"}`,"aria-label":"Notifications",style:({isActive:p})=>p?{backgroundImage:"linear-gradient(to right, #FF9500, #FFB800)",boxShadow:"0 10px 24px rgba(255,149,0,0.28)"}:{color:"var(--sidebar-foreground)"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{color:"inherit"},children:[e.jsx("path",{d:"M12 3c-3 0-5 2.5-5 5.5v3.5l-2 2v1h14v-1l-2-2V8.5C17 5.5 15 3 12 3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 19a2 2 0 0 0 4 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),e.jsx("span",{className:"link-label",children:"Notifications"})]})}),e.jsx("li",{children:e.jsxs(he,{to:"/admin/settings",className:({isActive:p})=>`flex items-center gap-4 px-4 py-2.5 rounded-[18px] ${p?"text-white":"hover:bg-white/5"}`,"aria-label":"Settings",style:({isActive:p})=>p?{backgroundImage:"linear-gradient(to right, #FF9500, #FFB800)",boxShadow:"0 10px 24px rgba(255,149,0,0.28)"}:{color:"var(--sidebar-foreground)"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{color:"inherit"},children:[e.jsx("path",{d:"M12 9a3 3 0 1 1 0 6 3 3 0 0 1 0-6Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M19 8l2 2-2 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M5 8 3 10l2 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 5l2-2 2 2M8 19l2 2 2-2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),e.jsx("span",{className:"link-label",children:"Settings"})]})})]})}),e.jsx("div",{className:"sidebar-foot",children:e.jsxs("button",{className:"group w-full inline-flex items-center justify-center gap-3 h-12 rounded-2xl text-white font-semibold bg-gradient-to-r from-red-600 to-rose-500 shadow-[0_10px_24px_rgba(244,63,94,0.25)] hover:brightness-105 hover:shadow-[0_14px_32px_rgba(244,63,94,0.35)] transition-all duration-150 ease-out active:translate-y-px focus:outline-none focus-visible:ring-2 focus-visible:ring-red-400/60",onClick:()=>{try{localStorage.removeItem("bakery_app_auth"),localStorage.removeItem("bakery_user_role")}catch(p){console.warn("failed clearing auth",p)}y("/login",{replace:!0})},"aria-label":"Logout",children:[e.jsxs("svg",{className:"w-5 h-5 opacity-95",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"3",y:"4",width:"4",height:"16",rx:"1",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M9 12h8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M9 8l4 4-4 4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("span",{className:"link-label",children:"Logout"})]})})]}),c&&e.jsx("div",{className:"sidebar-backdrop",onClick:()=>a(!1),"aria-hidden":!0})]})}function fe(s){return s==null?"-":Number(s).toLocaleString(void 0,{maximumFractionDigits:2})}function Fe(){const s=le(),[l,c]=o.useState(0),[a,y]=o.useState(0),[p,j]=o.useState(0),[n,b]=o.useState(0),W=new Date,q=W.toLocaleDateString(void 0,{weekday:"long"}),w=W.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"});return o.useEffect(()=>{try{const k=localStorage.getItem("bakery_app_v1"),u=k?JSON.parse(k):{},d=Array.isArray(u.sales)?u.sales:[];let Y=0,K=0,T=0;const D=new Date().toISOString().slice(0,10);d.forEach(L=>{try{let S=0;Array.isArray(L.items)&&L.items.length?L.items.forEach(C=>{const f=Number(C.subtotal??C.price*C.quantity??0)||0;S+=f}):S=Number(L.total??L.totalAmount??0)||0,Y+=S,(L.saleDate||L.timestamp||L.ts?new Date(L.saleDate||L.timestamp||L.ts).toISOString().slice(0,10):D)===D&&(K+=S,T+=1)}catch{}}),c(d.length),y(Y),j(K),b(T)}catch{c(0),y(0),j(0),b(0)}},[]),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"rounded-3xl p-6 sm:p-7 bg-gradient-to-br from-[#0f172a] via-[#111c2b] to-[#0f172a] shadow-[0_20px_60px_rgba(2,6,23,0.35)] ring-1 ring-white/5 flex items-center justify-between gap-6",style:{marginTop:8,marginBottom:12},children:[e.jsxs("div",{className:"flex items-center gap-5 min-w-0",children:[e.jsx("div",{className:"w-16 h-16 sm:w-18 sm:h-18 rounded-2xl bg-gradient-to-br from-orange-400 to-amber-500 shadow-[0_12px_28px_rgba(255,149,0,0.35)] flex items-center justify-center text-white shrink-0",children:e.jsxs("svg",{width:"34",height:"34",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"5",y:"3",width:"14",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M9 8h6M9 12h6M9 16h6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M12 6v12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",opacity:"0.2"})]})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-white text-3xl sm:text-4xl font-extrabold leading-tight truncate",children:"Dashboard"}),e.jsx("p",{className:"text-slate-300 text-base sm:text-lg mt-1 truncate",children:"Here's what's happening at your bakery today"})]})]}),e.jsxs("div",{className:"hidden sm:flex flex-col items-end ml-4",children:[e.jsx("div",{className:"text-slate-400 text-sm",children:q}),e.jsx("div",{className:"text-white text-lg font-semibold",children:w})]})]}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"card summary-card",children:[e.jsx("h4",{className:"summary-label",children:"All-time sales"}),e.jsx("div",{className:"summary-value",children:fe(l)})]}),e.jsxs("div",{className:"card summary-card",children:[e.jsx("h4",{className:"summary-label",children:"Total revenue"}),e.jsxs("div",{className:"summary-value",children:[fe(a)," Birr"]})]}),e.jsxs("div",{className:"card summary-card",children:[e.jsx("h4",{className:"summary-label",children:"Today's revenue"}),e.jsxs("div",{className:"summary-value",children:[fe(p)," Birr"]})]}),e.jsxs("div",{className:"card summary-card",children:[e.jsx("h4",{className:"summary-label",children:"Today's receipts"}),e.jsx("div",{className:"summary-value",children:fe(n)})]})]}),e.jsxs("div",{className:"card",style:{marginTop:16},children:[e.jsx("h3",{children:"Available pages"}),e.jsxs("div",{className:"nav-grid",children:[e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card blue",onClick:()=>s("/admin/sales"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/sales")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M7 3h10v18l-2-1-2 1-2-1-2 1-2-1-2 1V3z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.jsx("path",{d:"M8.5 7H15.5M8.5 10H15.5M8.5 13H13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx("div",{className:"nav-title",children:"Sales Management"}),e.jsx("div",{className:"nav-sub",children:"POS Insights"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card green",onClick:()=>s("/admin/inventory"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/inventory")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"4",y:"7",width:"16",height:"12",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M4 11h16M10 7v4M14 7v4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx("div",{className:"nav-title",children:"Inventory"}),e.jsx("div",{className:"nav-sub",children:"Stock Status"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card purple",onClick:()=>s("/admin/employees"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/employees")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M8 11a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M16 12.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M3 20c0-3.314 3.134-6 7-6s7 2.686 7 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx("div",{className:"nav-title",children:"Employees"}),e.jsx("div",{className:"nav-sub",children:"Performance"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card orange",onClick:()=>s("/admin/profits"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/profits")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M4 16l5-5 3 3 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 20h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx("div",{className:"nav-title",children:"Profits"}),e.jsx("div",{className:"nav-sub",children:"Financial Analytics"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card brown",onClick:()=>s("/admin/production"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/production")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M3 7h8a5 5 0 0 1 5 5v5H3V7z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.jsx("path",{d:"M16 12a5 5 0 0 1 5 5v0H16v-5z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"})]})}),e.jsx("div",{className:"nav-title",children:"Production"}),e.jsx("div",{className:"nav-sub",children:"Bakery Overview"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card teal",onClick:()=>s("/admin/expenses"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/expenses")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"3",y:"6",width:"18",height:"12",rx:"2",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M3 10h18",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("div",{className:"nav-title",children:"Expenses"}),e.jsx("div",{className:"nav-sub",children:"Cost Tracking"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card blue-muted",onClick:()=>s("/admin/reports"),onKeyDown:k=>{k.key==="Enter"&&s("/admin/reports")},children:[e.jsx("div",{className:"nav-icon inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white/10 text-white",children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M4 20h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("rect",{x:"6",y:"10",width:"3",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"2"}),e.jsx("rect",{x:"11",y:"7",width:"3",height:"9",rx:"1",stroke:"currentColor",strokeWidth:"2"}),e.jsx("rect",{x:"16",y:"12",width:"3",height:"4",rx:"1",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("div",{className:"nav-title",children:"Payment Tracker"}),e.jsx("div",{className:"nav-sub",children:"Method Totals"})]})]}),e.jsx("p",{className:"footer-note",children:"These are small starter pages â€” each contains a sample chart and a short description. Connect them to your real data as needed."})]})]})}function ge(s="bakery_channel"){let l=null;try{"BroadcastChannel"in window&&(l=new BroadcastChannel(s))}catch{l=null}function c(y){try{if(l){try{l.postMessage(y),console.debug("[Broadcast] post via BroadcastChannel",y)}catch(j){console.debug("[Broadcast] bc.postMessage error",j)}return}const p=`__bc_${s}`;localStorage.setItem(p,JSON.stringify({message:y,t:Date.now(),__via:"localStorage"})),setTimeout(()=>{try{localStorage.removeItem(p)}catch{}},500)}catch(p){console.warn("broadcast post failed",p)}}function a(y){if(l)return l.onmessage=j=>{try{let n=j.data;n&&n.message&&(n=n.message),n&&typeof n=="object"&&(n.__via=n.__via||"broadcast"),console.debug("[Broadcast] received via BroadcastChannel",n),y(n)}catch{}},()=>{try{l.close()}catch{}};function p(j){try{if(!j.key)return;const n=`__bc_${s}`;if(j.key!==n||!j.newValue)return;const b=JSON.parse(j.newValue);let W=b&&b.message?b.message:b;W&&typeof W=="object"&&(W.__via=W.__via||"localStorage"),console.debug("[Broadcast] received via localStorage fallback",W,b),y(W)}catch{}}return window.addEventListener("storage",p),()=>window.removeEventListener("storage",p)}return{post:c,listen:a}}const de={Dabo:[{label:"Dabo - 8.00",value:8},{label:"Dabo - 9.00",value:9},{label:"Dabo - 10.00",value:10},{label:"Dabo - 15.00",value:15},{label:"Dabo - 20.00",value:20},{label:"Dabo - 25.00",value:25},{label:"Dabo - 30.00",value:30},{label:"Dabo - 40.00",value:40},{label:"Dabo - 50.00",value:50}],DFO:[{label:"DFO - 60.00",value:60},{label:"DFO - 80.00",value:80},{label:"DFO - 120.00",value:120},{label:"DFO - 160.00",value:160},{label:"DFO - 200.00",value:200},{label:"DFO - 350.00",value:350},{label:"DFO - 500.00",value:500}],Cake:[{label:"Slice - 50.00",value:50},{label:"Venus - 50.00",value:50},{label:"Chocolate - 50.00",value:50},{label:"Kurebat - 50.00",value:50},{label:"Dry - 50.00",value:50},{label:"Gato - 50.00",value:50},{label:"Maffin - 50.00",value:50},{label:"Coruscant - 50.00",value:50},{label:"Danish - 50.00",value:50},{label:"Cream cake gateau - 100.00",value:100},{label:"Candy - 70.00",value:70},{label:"Chocolate (large) - 70.00",value:70},{label:"Black Forest - 70.00",value:70},{label:"White Forest - 70.00",value:70},{label:"Milliphone - 70.00",value:70},{label:"Opera - 70.00",value:70},{label:"Strawberry - 70.00",value:70},{label:"Whole Cake - 600.00",value:600}],Torta:[{label:"Torta White - 1kg 800.00",value:800},{label:"Torta White - 1.5kg 1100.00",value:1100},{label:"Torta White - 2kg 1600.00",value:1600},{label:"Black Torta - 1kg 900.00",value:900},{label:"Black Torta - 1.5kg 1200.00",value:1200},{label:"Black Torta - 0.5kg 600.00",value:600}],Donut:[{label:"Mini Donut - 50.00",value:50},{label:"Regular Donut - 50.00",value:50}],Cookies:[{label:"1kg - 500.00",value:500},{label:"1/2 kg - 250.00",value:250},{label:"1/4 kg - 125.00",value:125}],BreadCorn:[{label:"1kg - 400.00",value:400},{label:"1/2 kg - 200.00",value:200},{label:"1/4 kg - 100.00",value:100}],Baklava:[{label:"Wrapped - 85.00",value:85},{label:"Unwrapped - 60.00",value:60}],KeshKesh:[{label:"1kg - 200.00",value:200},{label:"1/2 kg - 100.00",value:100},{label:"1/4 kg - 50.00",value:50},{label:"1/8 kg - 25.00",value:25}],Other:[{label:"Kita - 40.00",value:40},{label:"Biscuit - 25.00",value:25},{label:"Horse Biscuit - 30.00",value:30},{label:"Toast - 50.00",value:50},{label:"Sabusa - 25.00",value:25},{label:"Spring - 30.00",value:30},{label:"Fetira - 100.00",value:100}],Erteb:[{label:"Normal - 50.00",value:50},{label:"Bekechap - 60.00",value:60},{label:"Special - 100.00",value:100}]},Ne={Dabo:"ðŸž",DFO:"ðŸ¥–",Cake:"ðŸ°",Torta:"ðŸŽ‚",Donut:"ðŸ©",Cookies:"ðŸª",BreadCorn:"ðŸŒ½",Baklava:"ðŸ¯",KeshKesh:"ðŸ¥",Other:"ðŸ¥¡",Erteb:"ðŸ¥˜"};function ue(s){return Number(s||0).toFixed(2)+" Birr"}function ke(){try{const s=localStorage.getItem("bakery_app_v1");return s?JSON.parse(s):{products:de,sales:[],notifications:[]}}catch{return{products:de,sales:[],notifications:[]}}}function we(){const s=le(),[l,c]=o.useState(()=>ke()),[a,y]=o.useState(()=>(ke().sales||[]).map(t=>({...t,timestamp:new Date(t.saleDate||t.timestamp||Date.now())}))),[p,j]=o.useState(""),[n,b]=o.useState("All"),[W,q]=o.useState(null),[w,k]=o.useState(!1),[u,d]=o.useState([]),[Y,K]=o.useState("Cash"),T=0,[D,L]=o.useState(!1),[S,m]=o.useState(null),[C,f]=o.useState(()=>{try{return localStorage.getItem("bakery_app_auth")?JSON.parse(localStorage.getItem("bakery_app_auth")).user.username:"Cashier #1"}catch{return"Cashier #1"}}),[G,Z]=o.useState(()=>{try{return localStorage.getItem("bakery_cashier_name_locked")==="true"}catch{return!1}}),X=(()=>{var t;try{return((t=JSON.parse(sessionStorage.getItem("bakery_app_auth")||"{}").user)==null?void 0:t.username)||""}catch{return""}})(),N=o.useMemo(()=>ge("bakery_updates"),[]);function h(){try{sessionStorage.removeItem("bakery_app_auth"),sessionStorage.removeItem("bakery_user_role"),localStorage.removeItem("bakery_app_auth"),localStorage.removeItem("bakery_app_auth_cashier"),localStorage.removeItem("bakery_force_logout_cashier")}catch{}s("/login",{replace:!0})}o.useEffect(()=>{try{const t=JSON.parse(localStorage.getItem("bakery_app_auth")||"{}");t.user||(t.user={}),t.user.username=C,localStorage.setItem("bakery_app_auth",JSON.stringify(t))}catch{}},[C]),o.useEffect(()=>{try{localStorage.setItem("bakery_cashier_name_locked",String(G)),G&&localStorage.setItem("bakery_cashier_name_locked_for",C||X||"")}catch{}},[G]),o.useEffect(()=>{try{const t=localStorage.getItem("bakery_cashier_name_locked_for")||"",i=X;t&&i&&t!==i&&Z(!1)}catch{}},[]),o.useEffect(()=>{function t(i){if(i&&i.key){if(i.key==="bakery_force_logout_cashier"){try{sessionStorage.removeItem("bakery_app_auth"),sessionStorage.removeItem("bakery_user_role"),localStorage.removeItem("bakery_app_auth_cashier")}catch{}s("/login?next=/cashier",{replace:!0});return}if(i.key!=="bakery_app_v1")return}try{const g=JSON.parse(localStorage.getItem("bakery_app_v1")||"{}");g&&c(g)}catch{}}window.addEventListener("storage",t);try{localStorage.getItem("bakery_force_logout_cashier")&&(sessionStorage.removeItem("bakery_app_auth"),sessionStorage.removeItem("bakery_user_role"),localStorage.removeItem("bakery_app_auth_cashier"),s("/login?next=/cashier",{replace:!0}))}catch{}return()=>{window.removeEventListener("storage",t)}},[]);function v(t,i){const g=`${t} - ${i.label}`,_=u.findIndex(P=>P.productLabel===g&&P.price===i.value);_>=0?d(P=>{const $=[...P],ee={...$[_]};return ee.qty+=1,ee.subtotal=ee.qty*ee.price,$[_]=ee,$}):d(P=>[...P,{productKey:t,productLabel:g,priceLabel:String(i.value),price:Number(i.value),qty:0,subtotal:0}]),q(null)}function z(t,i){d(g=>{const _=[...g],P={..._[t]},$=P.qty+i;return $<0?g:(P.qty=$,P.subtotal=P.qty*P.price,_[t]=P,_)})}function B(t,i){let g=parseInt(i);isNaN(g)&&(g=0),!(g<0)&&d(_=>{const P=[..._],$={...P[t]};return $.qty=g,$.subtotal=$.qty*$.price,P[t]=$,P})}function E(t){d(i=>i.filter((g,_)=>_!==t))}function A(){d([])}function M(){if(u.length===0||u.some($=>$.qty===0))return;const i=u.reduce(($,ee)=>$+ee.subtotal,0),g=new Date,_={saleId:`S-${g.getTime()}`,cashier:C,paymentMethod:Y,saleDate:g.toISOString(),items:u.map($=>({name:$.productLabel,quantity:$.qty,price:$.price,subtotal:$.subtotal})),total:i,totalAmount:i,discount:T},P={...l};P.sales=P.sales||[],P.sales.push(_),c(P),localStorage.setItem("bakery_app_v1",JSON.stringify(P)),N.post({type:"SALE_ADDED",sale:_}),d([]),y($=>[...$,{..._,timestamp:g}]);try{V()}catch{}m(_),L(!0),setTimeout(()=>L(!1),2500)}function V(){try{const t=new(window.AudioContext||window.webkitAudioContext),i=t.createOscillator(),g=t.createGain();i.type="sine",i.frequency.value=900,g.gain.value=.1,i.connect(g),g.connect(t.destination),i.start(),setTimeout(()=>i.stop(),100)}catch{}}const Q=l&&l.products?l.products:de,I=["All",...Object.keys(Q)],H=Object.keys(Q).filter(t=>!(n!=="All"&&t!==n||p&&!t.toLowerCase().includes(p.toLowerCase()))),R=t=>{const i=Q[t];!i||i.length===0||(i.length===1?v(t,i[0]):q({key:t,variants:i}))},ae=u.reduce((t,i)=>t+i.subtotal,0),O=ae,U=u.reduce((t,i)=>t+i.qty,0),r=u.some(t=>t.qty===0);return e.jsxs("div",{className:"cashier-root",children:[e.jsxs("div",{className:"pos-topbar",children:[e.jsxs("div",{className:"pos-brand",children:[e.jsx("span",{children:"âš¡"})," Bakery POS"]}),e.jsxs("div",{className:"pos-actions",children:[e.jsxs("div",{className:"cashier-name-group",children:[e.jsx("span",{className:"cng-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-amber-700",children:[e.jsx("circle",{cx:"12",cy:"8",r:"4"}),e.jsx("path",{d:"M6 20v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"})]})}),e.jsx("input",{className:"px-3 py-1.5 rounded-md border border-amber-200 bg-white/80 text-[14px] focus:outline-none focus:ring-2 focus:ring-orange-400/70 focus:border-orange-400 placeholder:text-amber-700/60 shadow-sm",value:C,onChange:t=>f(t.target.value),placeholder:"Cashier Name",disabled:G}),e.jsx("button",{type:"button",onClick:()=>{C.trim()&&Z(!0)},className:"ml-2 inline-flex items-center rounded-md px-2.5 py-1 text-xs font-semibold text-white bg-gradient-to-r from-orange-500 to-amber-500 hover:brightness-105 focus:outline-none focus:ring-2 focus:ring-orange-400 disabled:opacity-60",disabled:G,title:G?"Name saved":"Save name",children:"Save"}),G&&e.jsx("button",{type:"button",onClick:()=>{Z(!1)},className:"ml-2 inline-flex items-center rounded-md px-2.5 py-1 text-xs font-semibold text-amber-800 border border-amber-300 bg-white/80 hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-orange-400",title:"Edit name",children:"Edit"})]}),e.jsx("button",{className:"btn secondary",onClick:()=>k(!w),children:"History"}),e.jsxs("button",{onClick:h,className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 shadow hover:brightness-110 focus:outline-none focus:ring-2 focus:ring-red-400 transition",title:"Logout",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h2"}),e.jsx("path",{d:"M16 17l5-5-5-5"}),e.jsx("path",{d:"M21 12H9"})]}),e.jsx("span",{className:"font-semibold",children:"Logout"})]})]})]}),e.jsxs("div",{className:"pos-layout",children:[e.jsxs("div",{className:"pos-products-area",children:[e.jsxs("div",{className:"pos-search-bar",children:[e.jsxs("svg",{className:"search-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),e.jsx("input",{className:"pos-search-input",placeholder:"Search products...",value:p,onChange:t=>j(t.target.value)})]}),e.jsx("div",{className:"pos-categories",children:I.map(t=>e.jsxs("button",{className:`cat-pill ${n===t?"active":""}`,onClick:()=>b(t),children:[Ne[t]," ",t]},t))}),e.jsx("div",{className:"pos-grid",children:H.map(t=>{var _;const i=Q[t],g=i.length>1?`${i[0].value} - ${i[i.length-1].value}`:(_=i[0])==null?void 0:_.value;return e.jsxs("div",{className:"product-card",onClick:()=>R(t),children:[e.jsx("div",{className:"pc-icon",children:Ne[t]||"ðŸ“¦"}),e.jsx("div",{className:"pc-name",children:t}),e.jsxs("div",{className:"pc-price",children:[g," Birr"]})]},t)})})]}),e.jsxs("div",{className:"pos-cart-area",children:[e.jsxs("div",{className:"cart-header",children:[e.jsxs("div",{className:"cart-title",children:["Current Order",e.jsx("span",{className:"cart-count",children:u.reduce((t,i)=>t+i.qty,0)})]}),u.length>0&&e.jsx("button",{className:"btn ghost",style:{color:"var(--danger)",fontSize:13},onClick:A,children:"Clear"})]}),e.jsx("div",{className:"cart-items",children:u.length===0?e.jsxs("div",{style:{textAlign:"center",color:"var(--muted)",marginTop:60},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.5},children:"ðŸ›’"}),e.jsx("div",{style:{fontWeight:500},children:"Cart is empty"}),e.jsx("div",{style:{fontSize:13,marginTop:4},children:"Select products to start"})]}):u.map((t,i)=>e.jsxs("div",{className:"cart-item",children:[e.jsxs("div",{className:"ci-info",children:[e.jsx("div",{className:"ci-name",children:t.productLabel}),e.jsx("div",{className:"ci-price",children:ue(t.price)})]}),e.jsxs("div",{className:"ci-controls",children:[e.jsx("button",{className:"qty-btn",onClick:()=>z(i,-1),children:"âˆ’"}),e.jsx("input",{className:"qty-input",type:"number",value:t.qty===0?"":t.qty,placeholder:"0",onChange:g=>B(i,g.target.value),onFocus:g=>g.target.select()}),e.jsx("button",{className:"qty-btn",onClick:()=>z(i,1),children:"+"}),e.jsx("button",{className:"del-btn",onClick:()=>E(i),children:"ðŸ—‘"})]})]},i))}),e.jsxs("div",{className:"cart-footer",children:[e.jsxs("div",{className:"cf-row",children:[e.jsx("label",{children:"Payment"}),e.jsxs("select",{className:"cf-select",value:Y,onChange:t=>K(t.target.value),children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Telebirr"}),e.jsx("option",{children:"Bank"})]})]}),e.jsxs("div",{className:"cf-row",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{style:{fontWeight:600,color:"var(--text)"},children:ue(ae)})]}),e.jsxs("div",{className:"cf-total",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:ue(O)})]}),e.jsxs("button",{className:"pay-btn",disabled:u.length===0||U===0||r,onClick:M,children:[e.jsx("span",{children:"Complete Sale"}),e.jsx("span",{children:"â†’"})]})]})]})]}),W&&e.jsx("div",{className:"variant-modal-overlay",onClick:()=>q(null),children:e.jsxs("div",{className:"variant-modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:8},children:["Select ",W.key," Variant"]}),e.jsx("p",{style:{color:"var(--muted)",fontSize:14,marginBottom:20},children:"Choose a specific item to add to cart"}),e.jsx("div",{className:"vm-grid",children:W.variants.map((t,i)=>e.jsxs("button",{className:"vm-btn",onClick:()=>v(W.key,t),children:[e.jsx("span",{className:"vm-label",children:t.label}),e.jsxs("span",{className:"vm-price",children:[t.value," Birr"]})]},i))}),e.jsx("button",{className:"btn secondary",style:{width:"100%",marginTop:24,padding:14},onClick:()=>q(null),children:"Cancel"})]})}),w&&e.jsx("div",{className:"variant-modal-overlay",onClick:()=>k(!1),children:e.jsxs("div",{className:"variant-modal",style:{width:600},onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{style:{marginTop:0},children:"Recent Sales"}),e.jsxs("div",{style:{maxHeight:400,overflowY:"auto",marginTop:16},children:[a.length===0&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--muted)"},children:"No sales yet"}),a.slice().reverse().slice(0,20).map((t,i)=>e.jsxs("div",{style:{padding:12,borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15},children:ue(t.total||t.totalAmount)}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:new Date(t.timestamp).toLocaleString()})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:t.paymentMethod}),e.jsxs("div",{style:{fontSize:12,color:"#999"},children:[t.items.length," items"]})]})]},i))]}),e.jsx("button",{className:"btn secondary",style:{width:"100%",marginTop:24},onClick:()=>k(!1),children:"Close"})]})}),D&&e.jsx("div",{className:"completion-overlay",onClick:()=>L(!1),children:e.jsxs("div",{className:"completion-card",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"completion-check",children:"âœ“"}),e.jsx("div",{className:"completion-msg",children:"Sale completed"}),S&&e.jsx("div",{className:"completion-sub",children:ue(S.total||S.totalAmount)})]})})]})}function Se(){try{const s=localStorage.getItem("bakery_app_v1");return s?JSON.parse(s):{products:de,sales:[]}}catch{return{products:de,sales:[]}}}function ze(){const s=le(),[l,c]=o.useState(()=>Se()),[a,y]=o.useState(()=>Se().products||de),[p,j]=o.useState(!1),[n,b]=o.useState(Object.keys(a)[0]||""),[W,q]=o.useState(""),w=o.useRef(null),k=o.useRef(null),u=o.useRef(null),[d,Y]=o.useState(""),K=(()=>{try{let x=sessionStorage.getItem("bakery_tab_id");return x||(x="tab-"+Date.now().toString(36)+"-"+Math.floor(Math.random()*1e4),sessionStorage.setItem("bakery_tab_id",x)),x}catch{return"tab-local"}})();o.useEffect(()=>{n||b(Object.keys(a)[0]||"")},[a]),o.useEffect(()=>{try{const x=localStorage.getItem("bakery_app_v1");if(x){const F=JSON.parse(x);F.products&&y(F.products)}}catch{}},[]),o.useEffect(()=>{const x=ge();u.current=x;const F=x.listen(J=>{try{if(!J||!J.type)return;if(J.type==="product:update:ack"){const{id:se,from:ie,__via:ce}=J;console.debug("[Sales] received product:update:ack",{id:se,from:ie,via:ce}),k.current&&k.current===se&&ie&&ie!==K&&(Y("Done"),q("Saved"),j(!1),k.current=null,w.current&&(clearTimeout(w.current),w.current=null),setTimeout(()=>Y(""),1200))}}catch{}});return()=>{try{F()}catch{}}},[]),o.useEffect(()=>{function x(F){try{if(!F)return;F.key==="bakery_app_v1"&&console.debug("[Sales] storage event bakery_app_v1 changed",{key:F.key,newValue:F.newValue?JSON.parse(F.newValue):null}),F.key&&F.key.startsWith("__bc_")&&console.debug("[Sales] storage event (broadcast fallback) key",F.key,F.newValue)}catch{}}return window.addEventListener("storage",x),()=>window.removeEventListener("storage",x)},[]);function T(x){try{const F=localStorage.getItem("bakery_app_v1"),J=F?JSON.parse(F):{},se=JSON.parse(JSON.stringify(x||{})),ie={...J||{},products:se};console.debug("[Sales] persist: writing full bakery_app_v1",{ns:ie,fromTab:K}),localStorage.setItem("bakery_app_v1",JSON.stringify(ie)),c(ie),y(se),q("Saved");try{const ce="upd-"+Date.now().toString(36)+"-"+Math.floor(Math.random()*1e4);k.current=ce,Y("Waiting for cashier...");try{console.debug("[Sales] broadcasting product:update",{id:ce,from:K}),ge().post({type:"product:update",payload:se,id:ce,from:K})}catch(be){console.error("[Sales] broadcast failed",be)}w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{k.current===ce&&(Y("Saved (no ACK)"),k.current=null,j(!1),setTimeout(()=>Y(""),1500))},1600)}catch{}j(!1),setTimeout(()=>q(""),1600)}catch{q("Save failed")}}function D(x){ee({open:!0,type:"group",key:x})}function L(x,F){const J={...a};J[n]=J[n].map((se,ie)=>ie===x?{...se,...F}:se),y(J),j(!0)}function S(x){ee({open:!0,type:"variant",index:x,group:n})}const m=o.useMemo(()=>Object.keys(a||{}),[a]),[C,f]=o.useState(""),[G,Z]=o.useState(!1),X=o.useRef(null);o.useEffect(()=>{if(n){const x=n.replace(/([A-Z])/g," $1").trim();f(x)}else f("");Z(!1)},[n]);function N(){if(!n)return;const x=(C||"").trim();if(!x){f(n.replace(/([A-Z])/g," $1").trim()),Z(!1);return}const F=x.replace(/\s+/g,"");if(F===n){Z(!1),f(x);return}if(a[F]){alert("Group already exists"),f(n.replace(/([A-Z])/g," $1").trim()),Z(!1);return}const J={...a},se=Array.isArray(J[n])?J[n].map(ie=>({...ie})):[];J[F]=se,delete J[n],console.debug("[Sales] commitRename",{from:n,to:F,variantsCount:se.length,nextKeys:Object.keys(J)}),y(J),b(F),j(!0),Z(!1)}const[h,v]=o.useState(!1),[z,B]=o.useState(!1),[E,A]=o.useState(""),[M,V]=o.useState(!1),[Q,I]=o.useState(""),[H,R]=o.useState("");function ae(){v(!0)}function O(){try{T(de)}catch{}v(!1)}function U(){v(!1)}function r(){B(!0),A(""),setTimeout(()=>{try{const x=document.getElementById("newGroupInput");x&&x.focus()}catch{}},50)}function t(){const x=(E||"").trim();if(!x)return alert("Enter a group name");const F=x.replace(/\s+/g,"");if(a[F]){alert("Group already exists");return}const J={...a,[F]:[{label:`${x} - 0.00`,value:0}]};y(J),b(F),j(!0),B(!1)}function i(){B(!1),A("")}function g(){if(!n){alert("Select a group first");return}V(!0),I(""),R(""),setTimeout(()=>{try{const x=document.getElementById("newVariantInput");x&&x.focus()}catch{}},50)}function _(){const x=(Q||"").trim();if(!x)return alert("Enter variant label");const F=Number(H||0),J={...a};J[n]=[...J[n]||[],{label:x,value:F}],y(J),j(!0),V(!1)}function P(){V(!1),I(""),R("")}const[$,ee]=o.useState({open:!1,type:"",key:"",index:-1,group:""});function te(){const{type:x}=$||{};if(x==="group"){const F=$.key,J={...a};delete J[F],y(J),j(!0),n===F&&b(Object.keys(J)[0]||"")}else if(x==="variant"){const F=$.index,J=$.group||n;if(!J){ee({open:!1,type:""});return}const se={...a};se[J]=(se[J]||[]).filter((ie,ce)=>ce!==F),y(se),j(!0)}ee({open:!1,type:""})}function re(){ee({open:!1,type:""})}return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header page-header",children:[e.jsx("div",{className:"logo","aria-hidden":!0,children:e.jsx("span",{className:"logo-mark",children:"B"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{className:"page-title",children:"Sales Management"}),e.jsx("div",{className:"muted small",children:"Manage cashier products and price variants"})]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{className:"btn",onClick:()=>s("/admin"),children:"Back to Dashboard"})})]}),e.jsxs("div",{className:"hero blue sales-hero",children:[e.jsx("div",{className:"icon inline-flex items-center justify-center w-12 h-12 rounded-xl bg-white/15 text-white shadow-[inset_0_0_0_1px_rgba(255,255,255,0.25)]",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-7 h-7",children:[e.jsx("rect",{x:"5",y:"3",width:"14",height:"18",rx:"2"}),e.jsx("path",{d:"M9 8h6M9 12h6M9 16h6",strokeLinecap:"round"})]})}),e.jsxs("div",{className:"meta",children:[e.jsx("h2",{children:"Manage products used by the Cashier"}),e.jsx("p",{children:"Edit groups, variants, and prices â€” changes take effect immediately in the cashier."})]})]}),e.jsxs("div",{className:"card product-crud",children:[$.open&&e.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:[e.jsx("div",{onClick:re,style:{position:"absolute",inset:0,background:"rgba(15,23,42,0.45)"}}),e.jsxs("div",{style:{position:"relative",background:"#fff",borderRadius:12,boxShadow:"0 30px 60px rgba(2,6,23,0.20)",width:"92%",maxWidth:420,padding:18},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:10},children:[e.jsx("div",{style:{width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",background:"#fef3c7",borderRadius:10,fontWeight:800},children:"!"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:800,fontSize:18},children:"Confirm deletion"}),e.jsx("div",{className:"muted",style:{fontSize:13},children:$.type==="group"?e.jsxs(e.Fragment,{children:["Are you sure you want to delete the group ",e.jsx("strong",{children:$.key.replace(/([A-Z])/g," $1").trim()}),"? This will remove all its variants."]}):e.jsxs(e.Fragment,{children:["Are you sure you want to remove this variant from ",e.jsx("strong",{children:($.group||n).replace(/([A-Z])/g," $1").trim()}),"?"]})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:re,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:te,style:{background:"linear-gradient(90deg,#ef4444,#f97316)",border:"none"},children:"Delete"})]})]})]}),h&&e.jsxs("div",{style:{marginBottom:12,padding:12,display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(90deg,#fff7ed,#fffbeb)",borderRadius:10,boxShadow:"0 6px 18px rgba(16,24,40,0.06)",border:"1px solid #fde68a"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:42,height:42,display:"flex",alignItems:"center",justifyContent:"center",background:"#fef3c7",borderRadius:8,fontWeight:700},children:"!"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700},children:"Reset products to defaults?"}),e.jsx("div",{style:{fontSize:13,color:"#475569"},children:"This will replace all groups and variants with the bundled defaults and save immediately."})]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn secondary",onClick:U,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:O,style:{background:"linear-gradient(90deg,#fb7185,#f97316)",border:"none",color:"#fff"},children:"Reset & Save"})]})]}),z&&e.jsx("div",{style:{marginBottom:12,padding:12,display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(90deg,#eef2ff,#f8fafc)",borderRadius:10,boxShadow:"0 6px 18px rgba(2,6,23,0.04)",border:"1px solid #c7d2fe"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:"#eef2ff",borderRadius:8,fontWeight:700},children:"ï¼‹"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{id:"newGroupInput",value:E,onChange:x=>A(x.target.value),placeholder:"New group name (e.g. Cake)",style:{padding:8,borderRadius:8,border:"1px solid #e6e9ef"}}),e.jsx("button",{className:"btn",onClick:t,children:"Add"}),e.jsx("button",{className:"btn secondary",onClick:i,children:"Cancel"})]})]})}),M&&e.jsx("div",{style:{marginBottom:12,padding:12,display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(90deg,#ecfdf5,#f0fdf4)",borderRadius:10,boxShadow:"0 6px 18px rgba(4,120,87,0.04)",border:"1px solid #bbf7d0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:"#dcfce7",borderRadius:8,fontWeight:700},children:"â‹¯"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{id:"newVariantInput",value:Q,onChange:x=>I(x.target.value),placeholder:"Variant label (e.g. 1kg)",style:{padding:8,borderRadius:8,border:"1px solid #e6e9ef"}}),e.jsx("input",{value:H,onChange:x=>R(x.target.value),placeholder:"Price",style:{padding:8,borderRadius:8,border:"1px solid #e6e9ef",width:100}}),e.jsx("button",{className:"btn",onClick:_,children:"Add"}),e.jsx("button",{className:"btn secondary",onClick:P,children:"Cancel"})]})]})}),e.jsxs("div",{className:"crud-top",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:r,children:"+ Add Group"}),e.jsx("button",{className:"btn",onClick:g,disabled:!n,children:"+ Add Variant"}),e.jsx("button",{className:"btn secondary",onClick:ae,children:"Reset to Defaults"})]}),e.jsx("div",{style:{color:"#6b7280"},children:d||W})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:18,marginTop:14},children:[e.jsxs("aside",{style:{borderRight:"1px solid #f1f5f9",paddingRight:12},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:e.jsx("strong",{children:"Product groups"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:m.length===0?e.jsx("div",{className:"muted",children:"No groups"}):m.map(x=>e.jsxs("div",{className:`side-btn ${x===n?"active":""}`,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{cursor:"pointer"},onClick:()=>b(x),children:x.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"side-small-btn",onClick:()=>{b(x),f(x.replace(/([A-Z])/g," $1").trim()),Z(!0),setTimeout(()=>{try{X.current&&X.current.focus()}catch{}},50)},children:"Rename"}),e.jsx("button",{className:"side-small-btn",onClick:()=>D(x),children:"Delete"})]})]},x))})]}),e.jsxs("section",{children:[e.jsx("div",{style:{marginTop:0,marginBottom:10},children:n?e.jsx("input",{ref:X,"aria-label":"Group name",value:C,onChange:x=>f(x.target.value),onBlur:()=>{N()},onKeyDown:x=>{x.key==="Enter"&&N(),x.key==="Escape"&&(f(n.replace(/([A-Z])/g," $1").trim()),Z(!1))},style:{fontSize:18,fontWeight:700,border:0,outline:"none",background:"transparent",padding:0}}):e.jsx("h3",{style:{marginTop:0,marginBottom:10},children:"Select a group"})}),n?e.jsxs("div",{children:[e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #eef2f6"},children:[e.jsx("th",{style:{padding:"8px 6px"},children:"Variant"}),e.jsx("th",{style:{padding:"8px 6px",width:140},children:"Price (Birr)"}),e.jsx("th",{style:{padding:"8px 6px",width:120},children:"Actions"})]})}),e.jsx("tbody",{children:(a[n]||[]).map((x,F)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f6f8fb"},children:[e.jsx("td",{style:{padding:8},children:e.jsx("input",{value:x.label,onChange:J=>L(F,{label:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6e9ef"}})}),e.jsx("td",{style:{padding:8},children:e.jsx("input",{value:x.value,onChange:J=>{const se=Number(J.target.value||0);L(F,{value:se})},style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6e9ef"}})}),e.jsx("td",{style:{padding:8},children:e.jsx("button",{className:"side-small-btn",onClick:()=>S(F),children:"Remove"})})]},F))})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,alignItems:"center"},children:[e.jsx("button",{className:"btn",onClick:()=>T(a),disabled:!p,children:"Save Changes"}),e.jsx("button",{className:"btn secondary",onClick:()=>{const x=l&&l.products||de;y(x),b(Object.keys(x)[0]||""),q("No changes"),j(!1),setTimeout(()=>q(""),1200)},children:"Cancel"}),e.jsx("div",{style:{marginLeft:12,color:"#6b7280",fontSize:13},children:d})]})]}):e.jsx("div",{className:"muted",children:"Select a product group to edit its variants and prices."})]})]})]})]})}function $e(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“¦"}),e.jsx("h1",{children:"Inventory / Stock Status"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"hero green",children:[e.jsx("div",{className:"icon",children:"ðŸ“¦"}),e.jsxs("div",{className:"meta",children:[e.jsx("h2",{children:"Monitor stock levels and low-stock alerts"}),e.jsx("p",{children:"Live ingredient levels, reorder suggestions and usage trends for ingredients and finished goods."})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"filters",children:[e.jsx("input",{type:"text",placeholder:"Search ingredient or product"}),e.jsx("select",{children:e.jsx("option",{children:"All categories"})})]}),e.jsx("div",{style:{height:280,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"chart-placeholder",children:"Chart disabled"})}),e.jsx("div",{id:"lowStock",style:{marginTop:12}}),e.jsx("p",{className:"footer-note",children:"Shows low-stock alerts when `localStorage.bakery_app_v1` contains an `inventory` or `stock` array."})]})]})}function qe(){const s=le(),[l,c]=o.useState([]),[a,y]=o.useState(!1),[p,j]=o.useState(null),[n,b]=o.useState({name:"",salary:"",placement:"Cashier",customPlacement:"",phone:"",startDate:new Date().toISOString().slice(0,10),paymentCycle:"weekly"});o.useEffect(()=>{try{const d=localStorage.getItem("bakery_employees");if(d){const Y=JSON.parse(d),K=Array.isArray(Y)?Y.map(T=>({paymentCycle:T.paymentCycle||"monthly",...T})):[];c(K)}}catch(d){console.error(d)}},[]);const W=d=>{c(d),localStorage.setItem("bakery_employees",JSON.stringify(d))},q=()=>{if(!n.name||!n.salary)return;const d=(n.customPlacement||"").trim()?n.customPlacement.trim():n.placement,{customPlacement:Y,...K}=n,T={id:Date.now(),...K,placement:d,salary:Number(n.salary)};W([T,...l]),b({name:"",salary:"",placement:"Cashier",customPlacement:"",phone:"",startDate:new Date().toISOString().slice(0,10),paymentCycle:"weekly"}),y(!1)},w=d=>{j(d)};function k(){p&&W(l.filter(d=>d.id!==p)),j(null)}function u(){j(null)}return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ‘¥"}),e.jsx("h1",{children:"Employees Management"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsx("div",{className:"section-title",children:"Staff List"}),e.jsx("button",{className:"btn",onClick:()=>y(!a),children:a?"Cancel":"+ Add Employee"})]}),a&&e.jsxs("div",{style:{background:"#f8fafc",padding:16,borderRadius:8,marginBottom:20,border:"1px solid #e2e8f0"},children:[e.jsx("h4",{style:{marginTop:0},children:"New Employee"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[e.jsx("button",{type:"button",onClick:()=>b({...n,paymentCycle:"weekly"}),style:{padding:"8px 14px",borderRadius:8,border:"1px solid "+(n.paymentCycle==="weekly"?"#f59e0b":"#e2e8f0"),background:n.paymentCycle==="weekly"?"linear-gradient(90deg,#FF9500,#FFB800)":"#fff",color:n.paymentCycle==="weekly"?"#fff":"#334155",fontWeight:600,boxShadow:n.paymentCycle==="weekly"?"0 6px 18px rgba(255,149,0,0.25)":"none"},children:"Weekly Paid"}),e.jsx("button",{type:"button",onClick:()=>b({...n,paymentCycle:"monthly"}),style:{padding:"8px 14px",borderRadius:8,border:"1px solid "+(n.paymentCycle==="monthly"?"#f59e0b":"#e2e8f0"),background:n.paymentCycle==="monthly"?"linear-gradient(90deg,#FF9500,#FFB800)":"#fff",color:n.paymentCycle==="monthly"?"#fff":"#334155",fontWeight:600,boxShadow:n.paymentCycle==="monthly"?"0 6px 18px rgba(255,149,0,0.25)":"none"},children:"Monthly Paid"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{value:n.name,onChange:d=>b({...n,name:d.target.value}),placeholder:"e.g. Abebe Kebede"})]}),e.jsxs("div",{className:"field",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{children:"Placement / Role"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("select",{style:{flex:"0 0 160px"},value:n.placement,onChange:d=>b({...n,placement:d.target.value}),children:[e.jsx("option",{children:"Cashier"}),e.jsx("option",{children:"Baker"}),e.jsx("option",{children:"Manager"}),e.jsx("option",{children:"Cleaner"}),e.jsx("option",{children:"Security"}),e.jsx("option",{children:"Other"})]}),e.jsx("input",{style:{flex:1},placeholder:"Or type custom role",value:n.customPlacement,onChange:d=>b({...n,customPlacement:d.target.value})})]}),e.jsx("small",{style:{marginTop:4,color:"#64748b"},children:"If you type a custom role it will override the selected one."})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Salary (Birr)"}),e.jsx("input",{type:"number",value:n.salary,onChange:d=>b({...n,salary:d.target.value}),placeholder:"0.00"})]})]}),e.jsxs("div",{className:"form-row",style:{marginTop:12},children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Phone Number"}),e.jsx("input",{value:n.phone,onChange:d=>b({...n,phone:d.target.value}),placeholder:"09..."})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Start Date"}),e.jsx("input",{type:"date",value:n.startDate,onChange:d=>b({...n,startDate:d.target.value})})]})]}),e.jsx("button",{className:"btn",style:{marginTop:16},onClick:q,children:"Save Employee"})]}),e.jsxs("div",{className:"employee-list",children:[l.length===0&&e.jsx("p",{className:"muted",style:{textAlign:"center",padding:20},children:"No employees added yet."}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:16,marginBottom:22},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg,#0ea5e9,#2563eb)",padding:16,borderRadius:14,color:"#fff",boxShadow:"0 10px 24px rgba(14,165,233,0.25)"},children:[e.jsx("div",{style:{fontSize:13,opacity:.85,fontWeight:600},children:"Weekly Paid"}),e.jsx("div",{style:{fontSize:26,fontWeight:800,marginTop:6},children:l.filter(d=>d.paymentCycle==="weekly").length}),e.jsxs("div",{style:{fontSize:12,marginTop:4,opacity:.9},children:["Total Salary: ",l.filter(d=>d.paymentCycle==="weekly").reduce((d,Y)=>d+Number(Y.salary||0),0).toLocaleString()," Birr"]})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg,#f59e0b,#ef4444)",padding:16,borderRadius:14,color:"#fff",boxShadow:"0 10px 24px rgba(245,158,11,0.25)"},children:[e.jsx("div",{style:{fontSize:13,opacity:.85,fontWeight:600},children:"Monthly Paid"}),e.jsx("div",{style:{fontSize:26,fontWeight:800,marginTop:6},children:l.filter(d=>d.paymentCycle==="monthly").length}),e.jsxs("div",{style:{fontSize:12,marginTop:4,opacity:.9},children:["Total Salary: ",l.filter(d=>d.paymentCycle==="monthly").reduce((d,Y)=>d+Number(Y.salary||0),0).toLocaleString()," Birr"]})]})]}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h4",{style:{margin:"0 0 10px",fontSize:16,fontWeight:700},children:"Weekly Paid Employees"}),l.filter(d=>d.paymentCycle==="weekly").length===0?e.jsx("div",{className:"muted",style:{fontSize:13},children:"None"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #f1f5f9",textAlign:"left"},children:[e.jsx("th",{style:{padding:10},children:"Name"}),e.jsx("th",{style:{padding:10},children:"Role"}),e.jsx("th",{style:{padding:10},children:"Phone"}),e.jsx("th",{style:{padding:10},children:"Start Date"}),e.jsx("th",{style:{padding:10,textAlign:"right"},children:"Salary"}),e.jsx("th",{style:{padding:10}})]})}),e.jsx("tbody",{children:l.filter(d=>d.paymentCycle==="weekly").map(d=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:10,fontWeight:600},children:d.name}),e.jsx("td",{style:{padding:10},children:e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 8px",borderRadius:4,fontSize:12},children:d.placement})}),e.jsx("td",{style:{padding:10},children:d.phone||"-"}),e.jsx("td",{style:{padding:10},children:d.startDate}),e.jsxs("td",{style:{padding:10,textAlign:"right"},children:[Number(d.salary).toLocaleString()," Birr"]}),e.jsx("td",{style:{padding:10,textAlign:"right"},children:e.jsx("button",{className:"btn ghost",style:{padding:"4px 8px",fontSize:12,color:"#ef4444"},onClick:()=>w(d.id),children:"Remove"})})]},d.id))})]})]}),e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("h4",{style:{margin:"0 0 10px",fontSize:16,fontWeight:700},children:"Monthly Paid Employees"}),l.filter(d=>d.paymentCycle==="monthly").length===0?e.jsx("div",{className:"muted",style:{fontSize:13},children:"None"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #f1f5f9",textAlign:"left"},children:[e.jsx("th",{style:{padding:10},children:"Name"}),e.jsx("th",{style:{padding:10},children:"Role"}),e.jsx("th",{style:{padding:10},children:"Phone"}),e.jsx("th",{style:{padding:10},children:"Start Date"}),e.jsx("th",{style:{padding:10,textAlign:"right"},children:"Salary"}),e.jsx("th",{style:{padding:10}})]})}),e.jsx("tbody",{children:l.filter(d=>d.paymentCycle==="monthly").map(d=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:10,fontWeight:600},children:d.name}),e.jsx("td",{style:{padding:10},children:e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 8px",borderRadius:4,fontSize:12},children:d.placement})}),e.jsx("td",{style:{padding:10},children:d.phone||"-"}),e.jsx("td",{style:{padding:10},children:d.startDate}),e.jsxs("td",{style:{padding:10,textAlign:"right"},children:[Number(d.salary).toLocaleString()," Birr"]}),e.jsx("td",{style:{padding:10,textAlign:"right"},children:e.jsx("button",{className:"btn ghost",style:{padding:"4px 8px",fontSize:12,color:"#ef4444"},onClick:()=>w(d.id),children:"Remove"})})]},d.id))})]})]})]})]}),p!==null&&e.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500},children:[e.jsx("div",{onClick:u,style:{position:"absolute",inset:0,background:"rgba(15,23,42,0.45)"}}),e.jsxs("div",{style:{position:"relative",background:"#fff",borderRadius:16,padding:24,width:"92%",maxWidth:420,boxShadow:"0 30px 60px rgba(2,6,23,0.35)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:12},children:[e.jsx("div",{style:{width:52,height:52,display:"flex",alignItems:"center",justifyContent:"center",background:"#fef3c7",borderRadius:14,fontWeight:800,fontSize:22,color:"#b45309"},children:"!"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:18,fontWeight:800,marginBottom:4},children:"Confirm Removal"}),e.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Are you sure you want to remove this employee? This action cannot be undone."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:4},children:[e.jsx("button",{className:"btn secondary",onClick:u,style:{padding:"8px 14px"},children:"Cancel"}),e.jsx("button",{className:"btn",onClick:k,style:{background:"linear-gradient(90deg,#ef4444,#f97316)",border:"none",padding:"8px 14px"},children:"Delete"})]})]})]})]})]})}function Je(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ’°"}),e.jsx("h1",{children:"Profits / Financial Analytics"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"hero orange",children:[e.jsx("div",{className:"icon",children:"ðŸ’°"}),e.jsxs("div",{className:"meta",children:[e.jsx("h2",{children:"Analyze profits and margins"}),e.jsx("p",{children:"Compare income vs expenses, view margins and growth trends across categories."})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"filters",children:e.jsxs("select",{children:[e.jsx("option",{children:"Daily"}),e.jsx("option",{children:"Weekly"}),e.jsx("option",{children:"Monthly"})]})}),e.jsx("div",{style:{height:280,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"chart-placeholder",children:"Chart disabled"})}),e.jsx("p",{className:"footer-note",children:"Hook this view to expense and sales data to compute profits over time."})]})]})}function Ue(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸž"}),e.jsx("h1",{children:"Bakery Production Overview"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"hero brown",children:[e.jsx("div",{className:"icon",children:"ðŸž"}),e.jsxs("div",{className:"meta",children:[e.jsx("h2",{children:"Production reports and ingredient usage"}),e.jsx("p",{children:"Details from bakery managers about items baked, ingredients used and waste generated."})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"filters",children:[e.jsx("select",{children:e.jsx("option",{children:"All ovens"})}),e.jsx("input",{type:"date"})]}),e.jsx("div",{style:{height:280,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"chart-placeholder",children:"Chart disabled"})}),e.jsx("p",{className:"footer-note",children:"Use this view to compare production vs sales and measure efficiency."})]})]})}function Ve(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ’³"}),e.jsx("h1",{children:"Expenses / Cost Tracking"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"nav-grid",style:{marginTop:24},children:[e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card blue",onClick:()=>s("/admin/expenses/admin"),onKeyDown:l=>{l.key==="Enter"&&s("/admin/expenses/admin")},children:[e.jsx("div",{className:"nav-icon",children:"ðŸ¢"}),e.jsx("div",{className:"nav-title",children:"Admin Expense"}),e.jsx("div",{className:"nav-sub",children:"Administrative Costs"})]}),e.jsxs("div",{role:"link",tabIndex:0,className:"nav-card green",onClick:()=>s("/admin/expenses/inventory"),onKeyDown:l=>{l.key==="Enter"&&s("/admin/expenses/inventory")},children:[e.jsx("div",{className:"nav-icon",children:"ðŸ“¦"}),e.jsx("div",{className:"nav-title",children:"Inventory Expense Analysis"}),e.jsx("div",{className:"nav-sub",children:"Stock & Supply Costs"})]})]})]})}function He(){const s=le(),[l,c]=o.useState(0),[a,y]=o.useState(0),[p,j]=o.useState(0),[n,b]=o.useState([]),[W,q]=o.useState([]),[w,k]=o.useState("all"),[u,d]=o.useState(!1),[Y,K]=o.useState("all"),[T,D]=o.useState("all"),[L,S]=o.useState(!1);o.useEffect(()=>{try{const N=localStorage.getItem("bakery_employees"),h=N?JSON.parse(N):[];b(Array.isArray(h)?h:[]);const v=Array.isArray(h)?h.filter(B=>(B.paymentCycle||"monthly")==="weekly").reduce((B,E)=>B+Number(E.salary||0),0):0,z=Array.isArray(h)?h.filter(B=>(B.paymentCycle||"monthly")==="monthly").reduce((B,E)=>B+Number(E.salary||0),0):0;c(v),y(z)}catch{c(0),y(0),b([])}try{const N=localStorage.getItem("bakery_employee_payments"),h=N?JSON.parse(N):[];q(Array.isArray(h)?h:[])}catch{q([])}try{const N=localStorage.getItem("bakery_admin_expenses"),h=N?JSON.parse(N):[],v=Array.isArray(h)?h.reduce((z,B)=>z+Number(B.amount||0),0):0;j(v)}catch{j(0)}},[]),o.useEffect(()=>{try{const N=localStorage.getItem("bakery_payment_filter");N&&k(N);const h=localStorage.getItem("bakery_allow_early");h&&S(h==="true")}catch{}},[]);function m(N){const h=N.cycleStart||N.lastPaid;return h?new Date(h):null}function C(N){const h=m(N);if(!h)return null;if((N.paymentCycle||"monthly")==="weekly")return new Date(h.getTime()+7*24*60*60*1e3);const z=h.getFullYear(),B=h.getMonth(),E=h.getDate(),A=new Date(z,B+1,E);return A.getMonth()!==(B+1)%12?new Date(z,B+2,0):A}function f(N){const h=C(N);return h?new Date>=h:!0}(()=>{let N=n||[];if(T==="weekly"&&(N=N.filter(A=>(A.paymentCycle||"monthly")==="weekly")),T==="monthly"&&(N=N.filter(A=>(A.paymentCycle||"monthly")==="monthly")),w==="all")return N;if(w==="due")return N.filter(A=>f(A));if(w==="weeklyDue")return N.filter(A=>(A.paymentCycle||"monthly")==="weekly"&&f(A));if(w==="monthlyDue")return N.filter(A=>(A.paymentCycle||"monthly")==="monthly"&&f(A));const h=new Date,v=new Date(h);v.setHours(0,0,0,0),v.setDate(v.getDate()-v.getDay());const z=new Date(v);z.setDate(v.getDate()+7);const B=new Date(h.getFullYear(),h.getMonth(),1),E=new Date(h.getFullYear(),h.getMonth()+1,1);return w==="thisWeek"?N.filter(A=>(A.paymentCycle||"monthly")==="weekly"&&(()=>{const M=A.lastPaid?new Date(A.lastPaid):null,V=M?new Date(M.getTime()+7*24*60*60*1e3):h;return f(A)&&V>=v&&V<z})()):w==="thisMonth"?N.filter(A=>(A.paymentCycle||"monthly")==="monthly"&&(()=>{const M=A.lastPaid?new Date(A.lastPaid):null;let V;return M?V=new Date(M.getFullYear(),M.getMonth()+1,M.getDate()):V=h,f(A)&&V>=B&&V<E})()):N})(),n.some(N=>f(N));const G=W.filter(N=>{const h=n.find(z=>z.id===N.employeeId);return(h&&h.paymentCycle?h.paymentCycle:"monthly")==="weekly"}),Z=W.filter(N=>{const h=n.find(z=>z.id===N.employeeId);return(h&&h.paymentCycle?h.paymentCycle:"monthly")==="monthly"});G.reduce((N,h)=>N+Number(h.amount||0),0),Z.reduce((N,h)=>N+Number(h.amount||0),0);function X(N){if(!m(N))return"notStarted";const v=C(N);if(!v)return"due";const z=new Date;return z>=v?Math.floor((z-v)/864e5)===0?"dueToday":"overdue":Math.ceil((v-z)/(1e3*60*60*24))<=2?"dueSoon":"active"}return n.reduce((N,h)=>{const v=X(h);return N[v]=(N[v]||0)+1,N},{}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ’³"}),e.jsx("h1",{children:"Payment Tracker"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:14,marginBottom:16},children:[e.jsxs("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#0ea5e9,#2563eb)",cursor:"pointer"},onClick:()=>s("/admin/payments/employees"),children:[e.jsx("div",{className:"sb-icon",children:"ðŸ‘¥"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Employee Payments"}),e.jsxs("div",{className:"sb-value",children:[(l+a).toLocaleString()," Birr"]}),e.jsxs("div",{className:"sb-desc",children:["Weekly: ",l.toLocaleString()," â€¢ Monthly: ",a.toLocaleString()]})]})]}),e.jsxs("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#f59e0b,#ef4444)",cursor:"pointer"},onClick:()=>s("/admin/payments/expenses"),children:[e.jsx("div",{className:"sb-icon",children:"ðŸ§¾"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Expense Payments"}),e.jsxs("div",{className:"sb-value",children:[p.toLocaleString()," Birr"]}),e.jsx("div",{className:"sb-desc",children:"Inventory & operations costs"})]})]})]})})]})}function Ge(){const s=le(),l={daily:null,weekly:null,monthly:null},c=a=>a!=null?a.toLocaleString(void 0,{style:"currency",currency:"USD"}):"â€”";return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“‘"}),e.jsx("h1",{children:"Summarry"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"muted",children:"Quick access to your daily, weekly and monthly summaries."}),e.jsxs("div",{className:"summary-panel",children:[e.jsxs("div",{className:"summary-box summary-daily",role:"button",tabIndex:0,style:{cursor:"pointer"},onClick:()=>s("/admin/summary/daily"),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&s("/admin/summary/daily")},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ“…"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Daily Summaries"}),e.jsx("div",{className:"sb-value",children:c(l.daily)}),e.jsx("div",{className:"sb-desc",children:"Today's revenue (sample)"})]})]}),e.jsxs("div",{className:"summary-box summary-weekly",role:"button",tabIndex:0,style:{cursor:"pointer"},onClick:()=>s("/admin/summary/weekly"),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&s("/admin/summary/weekly")},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ“ˆ"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Weekely Summaries"}),e.jsx("div",{className:"sb-value",children:c(l.weekly)}),e.jsx("div",{className:"sb-desc",children:"Last 7 days total (sample)"})]})]}),e.jsxs("div",{className:"summary-box summary-monthly",role:"button",tabIndex:0,style:{cursor:"pointer"},onClick:()=>s("/admin/summary/monthly"),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&s("/admin/summary/monthly")},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ—ƒï¸"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Monthly Summaries"}),e.jsx("div",{className:"sb-value",children:c(l.monthly)}),e.jsx("div",{className:"sb-desc",children:"Last 30 days total (sample)"})]})]})]})]})]})}function pe(){try{const s=localStorage.getItem("bakery_app_v1");return s?JSON.parse(s):{}}catch{return{}}}function Ke(){const s=le(),[l,c]=o.useState(()=>pe().notifications||[]),[a,y]=o.useState(""),[p,j]=o.useState("cashier"),[n,b]=o.useState("");o.useEffect(()=>{function w(k){k&&k.key&&k.key!=="bakery_app_v1"||c(pe().notifications||[])}return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[]);function W(){const w=(a||"").trim();if(!w){alert("Enter a message");return}const k=pe();k.notifications=k.notifications||[];const u={id:"N-"+Date.now(),from:"admin",to:p,message:w,timestamp:new Date().toISOString(),dismissedFor:[]};k.notifications.push(u);try{localStorage.setItem("bakery_app_v1",JSON.stringify(k)),c(k.notifications),y(""),alert("Notification sent");try{window.dispatchEvent(new Event("storage"))}catch{}try{ge().post({type:"notification",payload:u})}catch{}}catch(d){console.error(d),alert("Failed to save notification")}}function q(w){if(confirm("Delete this notification?"))try{const k=pe();k.notifications=(k.notifications||[]).filter(u=>u.id!==w),localStorage.setItem("bakery_app_v1",JSON.stringify(k)),c(k.notifications||[])}catch(k){console.error(k)}}return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header page-header",children:[e.jsx("div",{className:"logo","aria-hidden":!0,children:e.jsx("span",{className:"logo-mark",children:"ðŸ””"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{className:"page-title",children:"Notifications"}),e.jsx("div",{className:"muted small",children:"Send messages to Cashier or Ground Manager"})]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{className:"btn",onClick:()=>s("/admin"),children:"Back"})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{"aria-label":"Quick message",placeholder:"Quick message",value:n,onChange:w=>b(w.target.value),style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e6e9ef"}}),e.jsx("button",{className:"btn",onClick:()=>{const w=(n||"").trim();if(!w){alert("Enter a quick message");return}const k=pe();k.notifications=k.notifications||[];const u={id:"N-"+Date.now(),from:"admin",to:p,message:w,timestamp:new Date().toISOString(),dismissedFor:[]};k.notifications.push(u);try{localStorage.setItem("bakery_app_v1",JSON.stringify(k)),c(k.notifications),b("");try{window.dispatchEvent(new Event("storage"))}catch{}try{ge().post({type:"notification",payload:u})}catch{}alert("Notification sent")}catch(d){console.error(d),alert("Failed to save notification")}},children:"Send Quick"})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs("select",{value:p,onChange:w=>j(w.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6e9ef"},children:[e.jsx("option",{value:"cashier",children:"Cashier"}),e.jsx("option",{value:"ground",children:"Ground"}),e.jsx("option",{value:"all",children:"All"})]}),e.jsx("textarea",{value:a,onChange:w=>y(w.target.value),placeholder:"Type your message",style:{flex:1,padding:8,borderRadius:8,border:"1px solid #e6e9ef"},rows:3}),e.jsx("button",{className:"btn",onClick:W,children:"Send"})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("h3",{style:{margin:0,marginBottom:8},children:"Sent notifications"}),l.length===0?e.jsx("div",{className:"muted",children:"No notifications sent yet"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:l.slice().reverse().map(w=>{const u={cashier:"#2563eb",ground:"#10b981",all:"#7c3aed"}[w.to]||"#6b7280";return e.jsxs("div",{style:{padding:10,borderRadius:8,background:"#fff",border:"1px solid #eef2f6",display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:`4px solid ${u}`},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{fontWeight:700,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{display:"inline-block",width:10,height:10,borderRadius:3,background:u}}),e.jsx("span",{children:w.message})]}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[e.jsx("strong",{style:{textTransform:"capitalize",color:u},children:w.to})," â€¢ ",new Date(w.timestamp).toLocaleString()]})]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{className:"side-small-btn",onClick:()=>q(w.id),children:"Delete"})})]},w.id)})})]})]})]})}function oe(s){return s==null?"-":Number(s).toLocaleString(void 0,{maximumFractionDigits:2})+" Birr"}function Ze(s){try{let l=0;return Array.isArray(s.items)&&s.items.length?s.items.forEach(c=>{const a=Number(c.subtotal??c.price*c.quantity??0)||0;l+=a}):l=Number(s.total??s.totalAmount??0)||0,l}catch{return 0}}function Ye(s){const l=[s.paymentMethod,s.paidBy,s.payment,s.method,s.payMethod,s.tender];for(const c of l){if(!c)continue;const a=String(c).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr")||a.includes("telebirr")||a.includes("telbirr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank";if(a.includes("card")||a.includes("visa")||a.includes("master"))return"card"}if(Array.isArray(s.payments)&&s.payments.length){const c=s.payments[0];if(c&&c.method){const a=String(c.method).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank"}}return"other"}function Qe(){const s=le(),l=ve(),a=new URLSearchParams(l.search).get("date")||new Date().toISOString().slice(0,10),[y,p]=o.useState(()=>a),[j,n]=o.useState([]),[b,W]=o.useState({cash:[],telbirr:[],bank:[],card:[],other:[]});o.useEffect(()=>{try{const T=localStorage.getItem("bakery_app_v1"),D=T?JSON.parse(T):{},L=Array.isArray(D.sales)?D.sales:[],S=[],m=y;L.forEach(f=>{try{const G=Ze(f);if((f.saleDate||f.timestamp||f.ts?new Date(f.saleDate||f.timestamp||f.ts).toISOString().slice(0,10):null)===m){const X=Ye(f);S.push({id:f.id??f.saleId??f.txnId??f.ref??Math.random().toString(36).slice(2,9),time:f.saleDate||f.timestamp||f.ts?new Date(f.saleDate||f.timestamp||f.ts).toLocaleTimeString():"",total:G,cashier:f.cashier??f.user??f.staff??"",method:X,raw:f})}}catch{}});const C={cash:[],telbirr:[],bank:[],card:[],other:[]};S.forEach(f=>{C[f.method]?C[f.method].push(f):C.other.push(f)}),n(S),W(C)}catch{n([]),W({cash:[],telbirr:[],bank:[],card:[],other:[]})}},[y]);const q=T=>T.reduce((D,L)=>D+(Number(L.total)||0),0),[w,k]=o.useState(""),[u,d]=o.useState(null);function Y(){try{const T=j.slice(),D={};T.forEach(X=>{const N=(X.cashier||"Unknown").trim()||"Unknown";D[N]||(D[N]={});const h=X.method||"other";D[N][h]||(D[N][h]=[]),D[N][h].push(X)});const S=`<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px"><div><h1 style="margin:0;">Daily Receipt Collector</h1><div style="color:#666">Date: ${y}</div></div><div style="text-align:right"><div style="font-weight:700">Generated: ${new Date().toLocaleString()}</div></div></div>`,m=Object.keys(D).sort().map(X=>{const N=D[X],h=Object.keys(N).map(z=>{const B=N[z].map(A=>{const M=A.raw||A;let Q=((Array.isArray(M.items)?M.items:Array.isArray(M.lines)?M.lines:Array.isArray(M.orderItems)?M.orderItems:[])||[]).map(R=>{const ae=R.productLabel??R.label??R.name??R.title??R.product??R.description??"Item",O=Number(R.quantity??R.qty??R.q??1)||1,U=Number(R.price??R.unitPrice??R.value??R.amount??0)||0,r=Number(R.subtotal??R.total??U*O??0)||0;return{name:ae,qty:O,price:U,subtotal:r}});if(Q.length===0&&(M.total||M.totalAmount)&&(M.productLabel||M.product||M.title||M.name)){const R=M.productLabel??M.product??M.title??M.name??"Item",ae=Number(M.quantity??M.qty??1)||1,O=Number(M.price??M.amount??(M.total||M.totalAmount)/ae)||0,U=Number(M.total||M.totalAmount||O*ae)||0;Q.push({name:R,qty:ae,price:O,subtotal:U})}const I=Q.map(R=>`${R.name} Ã— ${R.qty} @ ${R.price.toFixed(2)} = ${R.subtotal.toFixed(2)} Birr`).join("<br/>"),H=Number(A.total||M.total||M.totalAmount||Q.reduce((R,ae)=>R+ae.subtotal,0)||0).toFixed(2);return`<tr><td style="padding:6px;border-bottom:1px solid #eee">${A.id}</td><td style="padding:6px;border-bottom:1px solid #eee">${A.time}</td><td style="padding:6px;border-bottom:1px solid #eee">${z}</td><td style="padding:6px;border-bottom:1px solid #eee">${I}</td><td style="padding:6px;border-bottom:1px solid #eee;text-align:right">${H} Birr</td></tr>`}).join(""),E=N[z].reduce((A,M)=>A+(Number(M.total)||0),0).toFixed(2);return`<h4 style="margin:8px 0 6px 0">${z.toUpperCase()} â€” Subtotal: ${E} Birr</h4><table style="width:100%;border-collapse:collapse;margin-bottom:12px"><thead><tr><th style="text-align:left;padding:6px;border-bottom:2px solid #ddd">Receipt</th><th style="padding:6px;border-bottom:2px solid #ddd">Time</th><th style="padding:6px;border-bottom:2px solid #ddd">Method</th><th style="padding:6px;border-bottom:2px solid #ddd">Items</th><th style="padding:6px;border-bottom:2px solid #ddd;text-align:right">Total</th></tr></thead><tbody>${B}</tbody></table>`}).join(""),v=Object.keys(N).reduce((z,B)=>z+N[B].reduce((E,A)=>E+(Number(A.total)||0),0),0).toFixed(2);return`<section style="margin-bottom:18px"><h3 style="margin:6px 0">Cashier: ${X} â€” Total: ${v} Birr</h3>${h}</section>`}).join(""),C=T.reduce((X,N)=>X+(Number(N.total)||0),0).toFixed(2),G=`<!doctype html><html><head><meta charset="utf-8"><title>Daily Receipts ${y}</title><style>body{font-family:Arial,Helvetica,sans-serif;color:#111;padding:20px}h1,h2,h3,h4{margin:0}table td,table th{vertical-align:top}</style></head><body>${S}${m}<div style="margin-top:18px;font-weight:800">Overall Total: ${C} Birr</div><script>window.onload=function(){setTimeout(()=>{try{window.print();}catch(e){}},300);};<\/script></body></html>`,Z=window.open("","_blank");Z&&(Z.document.open(),Z.document.write(G),Z.document.close())}catch(T){console.error("collectDay",T),alert("Failed to generate report")}}const K=Be.useMemo(()=>{const T={};return j.forEach(D=>{const L=(D.cashier||"Unknown").trim()||"Unknown";T[L]||(T[L]={entries:[],total:0}),T[L].entries.push(D),T[L].total+=Number(D.total)||0}),T},[j]);return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“…"}),e.jsx("h1",{children:"Daily Summaries"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/daily-summary"),children:"Back to Summarry"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:"Receipts for"}),e.jsx("div",{className:"muted",children:y})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"date",value:y,onChange:T=>p(T.target.value)}),e.jsx("button",{className:"btn",onClick:()=>{p(new Date().toISOString().slice(0,10))},children:"Today"}),e.jsx("button",{className:"btn ghost",onClick:Y,children:"Collect Day"})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{className:"summary-panel",children:[e.jsxs("div",{className:"summary-box summary-daily",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ“²"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"TelBirr"}),e.jsx("div",{className:"sb-value",children:oe(q(b.telbirr))}),e.jsx("div",{className:"sb-desc",children:"Total for the day"})]})]}),e.jsxs("div",{className:"summary-box summary-weekly",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ’µ"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Cash"}),e.jsx("div",{className:"sb-value",children:oe(q(b.cash))}),e.jsx("div",{className:"sb-desc",children:"Total for the day"})]})]}),e.jsxs("div",{className:"summary-box summary-monthly",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ¦"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Bank / Transfer"}),e.jsx("div",{className:"sb-value",children:oe(q(b.bank))}),e.jsx("div",{className:"sb-desc",children:"Total for the day"})]})]}),e.jsxs("div",{className:"summary-box summary-total",children:[e.jsx("div",{className:"sb-icon",children:"Î£"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Total"}),e.jsx("div",{className:"sb-value",children:oe(q(b.cash)+q(b.telbirr)+q(b.bank)||0)}),e.jsx("div",{className:"sb-desc",children:"Combined total for the day"})]})]})]}),e.jsxs("div",{style:{marginTop:14,display:"grid",gridTemplateColumns:"260px 1fr",gap:12},children:[e.jsx("aside",{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Cashiers"}),e.jsx("div",{onClick:()=>k(""),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card",style:{padding:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700},children:"All Cashiers"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[j.length," receipts"]})]}),e.jsx("div",{style:{fontWeight:800},children:oe(q(j))})]})}),Object.keys(K).sort((T,D)=>K[D].total-K[T].total).map(T=>e.jsx("div",{onClick:()=>k(T),style:{cursor:"pointer"},children:e.jsxs("div",{className:"card",style:{padding:12,display:"flex",justifyContent:"space-between",alignItems:"center",border:w===T?"2px solid #3b82f6":void 0},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700},children:T}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[K[T].entries.length," receipts"]})]}),e.jsx("div",{style:{fontWeight:800},children:oe(K[T].total)})]})},T))]})}),e.jsx("section",{children:(w?K[w]?K[w].entries:[]:j).length===0?e.jsx("div",{className:"muted",children:"No receipts"}):(w?K[w]?K[w].entries:[]:j).map(T=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #eee"},children:[e.jsxs("div",{style:{minWidth:260},children:[e.jsx("div",{style:{fontWeight:700},children:T.id}),e.jsxs("div",{className:"muted",style:{fontSize:13},children:[T.cashier," â€¢ ",T.time," â€¢ ",T.method]})]}),e.jsxs("div",{style:{textAlign:"right",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:8},children:[e.jsx("div",{style:{fontWeight:700},children:oe(T.total)}),e.jsx("div",{children:e.jsx("button",{className:"btn",onClick:()=>d(T),children:"View"})})]})]},T.id))})]})]})]}),u&&e.jsx(Xe,{receipt:u,onClose:()=>d(null)})]})}function Xe({receipt:s,onClose:l}){if(!s)return null;const c=s.raw||s,a=c.saleDate||c.timestamp||c.ts||new Date().toISOString(),p=((Array.isArray(c.items)?c.items:Array.isArray(c.lines)?c.lines:Array.isArray(c.orderItems)?c.orderItems:[])||[]).map(n=>{const b=n.productLabel??n.label??n.name??n.title??n.product??"Item",W=Number(n.quantity??n.qty??n.q??1)||1,q=Number(n.price??n.unitPrice??n.value??n.amount??0)||0,w=Number(n.subtotal??n.total??q*W??0)||0;return{name:b,qty:W,price:q,subtotal:w}}),j=Number(s.total||c.total||c.totalAmount||p.reduce((n,b)=>n+b.subtotal,0)||0);return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:500},onClick:l,children:e.jsxs("div",{role:"dialog","aria-modal":!0,style:{width:520,maxWidth:"96%",background:"#fff",borderRadius:12,padding:22,boxShadow:"0 30px 60px rgba(2,6,23,0.2)"},onClick:n=>n.stopPropagation(),children:[e.jsx("h2",{style:{marginTop:0,marginBottom:8},children:"Receipt"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontWeight:700},children:"Items"}),e.jsx("div",{style:{textAlign:"right",fontWeight:700},children:oe(j)})]}),e.jsx("div",{style:{borderTop:"1px solid #f1f5f9",borderBottom:"1px solid #f1f5f9",padding:"12px 0",marginBottom:12},children:p&&p.length?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:p.map((n,b)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700},children:n.name}),e.jsxs("div",{className:"muted",style:{fontSize:13},children:[n.qty," Ã— ",oe(n.price)]})]}),e.jsx("div",{style:{minWidth:110,textAlign:"right",fontWeight:700},children:oe(n.subtotal)})]},b))}):e.jsx("div",{className:"muted",children:"No item details available"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Payment"}),e.jsx("div",{style:{fontWeight:700},children:s.paymentMethod||s.payment||c.paymentMethod||"â€”"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,alignItems:"flex-end"},children:[e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Subtotal"}),e.jsx("div",{style:{fontWeight:700},children:oe(j)})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},children:[e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Date"}),e.jsx("div",{style:{fontWeight:700},children:(s.timestamp instanceof Date?s.timestamp:new Date(s.timestamp||a)).toLocaleString()})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},children:[e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Cashier"}),e.jsx("div",{style:{fontWeight:700},children:s.cashier||c.cashier||""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12,marginTop:18},children:[e.jsx("button",{className:"btn ghost",onClick:()=>{try{const n=`Receipt

${(p||[]).map(w=>`${w.name}	${w.qty} x ${w.price.toFixed(2)} = ${w.subtotal.toFixed(2)}`).join(`
`)}

Total: ${j.toFixed(2)}`,b=new Blob([n],{type:"text/plain"}),W=URL.createObjectURL(b),q=document.createElement("a");q.href=W,q.download=`receipt-${s.saleId||Date.now()}.txt`,q.click(),URL.revokeObjectURL(W)}catch(n){console.error(n)}},children:"Download"}),e.jsx("button",{className:"btn",onClick:()=>{try{const n=s.raw||s,b=n.timestamp instanceof Date?n.timestamp:new Date(n.timestamp||n.saleDate||n.ts),q=`<!doctype html><html><head><meta charset="utf-8"><title>Receipt</title><style>body{font-family:Arial,Helvetica,sans-serif;padding:20px}h2{margin-top:0}</style></head><body><h2>Receipt</h2>${(p||[]).map(k=>`<div style="display:flex;justify-content:space-between;margin:6px 0"><span>${k.name} Ã— ${k.qty}</span><strong>${oe(k.subtotal)}</strong></div>`).join("")}<div style="display:flex;justify-content:space-between;margin:6px 0"><span>Total</span><strong>${oe(j)}</strong></div><div style="display:flex;justify-content:space-between;margin:6px 0"><span>Date</span><strong>${b.toLocaleString()}</strong></div><div style="display:flex;justify-content:space-between;margin:6px 0"><span>Cashier</span><strong>${s.cashier||n.cashier||""}</strong></div><script>window.onload=function(){window.print();};<\/script></body></html>`,w=window.open("","_blank");w&&(w.document.open(),w.document.write(q),w.document.close())}catch(n){console.error(n)}},children:"Print Receipt"})]})]})})}function et({products:s=[]}){const l=o.useRef(null),c=o.useRef(null);return o.useEffect(()=>{const a=s.map(n=>n.label),y=s.map(n=>Number((n.rev||0).toFixed(2))),p=l.current&&l.current.getContext?l.current.getContext("2d"):null;if(!p)return;if(c.current){try{c.current.destroy()}catch{}c.current=null}const j=["#3b82f6","#ef4444","#f59e0b","#10b981","#8b5cf6","#ec4899","#06b6d4","#f97316"];return c.current=new je(p,{type:"bar",data:{labels:a,datasets:[{label:"Revenue",data:y,backgroundColor:a.map((n,b)=>j[b%j.length])}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}}),()=>{try{c.current&&c.current.destroy()}catch{}c.current=null}},[s]),e.jsx("canvas",{id:"prodChart",ref:l,className:"chart-canvas"})}function Ae(s){const l=new Date(s),a=(l.getDay()+6)%7;return l.setDate(l.getDate()-a),l.setHours(0,0,0,0),l}function tt(s){const l=Ae(s),c=new Date(l);return c.setDate(l.getDate()+6),c.setHours(23,59,59,999),c}function Ce(s){try{let l=0;return Array.isArray(s.items)&&s.items.length?s.items.forEach(c=>{const a=Number(c.subtotal??c.price*c.quantity??0)||0;l+=a}):l=Number(s.total??s.totalAmount??0)||0,l}catch{return 0}}function De(s){const l=[s.paymentMethod,s.paidBy,s.payment,s.method,s.payMethod,s.tender];for(const c of l){if(!c)continue;const a=String(c).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr")||a.includes("telebirr")||a.includes("telbirr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank";if(a.includes("card")||a.includes("visa")||a.includes("master"))return"card"}if(Array.isArray(s.payments)&&s.payments.length){const c=s.payments[0];if(c&&c.method){const a=String(c.method).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank"}}return"other"}function xe(s){return s==null?"-":Number(s).toLocaleString(void 0,{maximumFractionDigits:2})+" Birr"}function st(){const s=le(),[l,c]=o.useState(()=>new Date().toISOString().slice(0,10)),a=o.useMemo(()=>{const h=new Date(l),v=Ae(h),z=tt(h);return{start:v,end:z}},[l]),[y,p]=o.useState({telbirr:0,cash:0,bank:0}),[j,n]=o.useState([]),[b,W]=o.useState({labels:[],data:[]}),[q,w]=o.useState([]),[k,u]=o.useState({labels:[],telbirr:[],cash:[],bank:[]}),[d,Y]=o.useState({total:0,avgDaily:0,orders:0}),[K,T]=o.useState(!1),D=o.useRef(null),L=o.useRef(null),S=o.useRef(null),m=o.useRef(null);o.useEffect(()=>{try{const h=localStorage.getItem("bakery_app_v1"),v=h?JSON.parse(h):{},z=Array.isArray(v.sales)?v.sales:[];let B=0,E=0,A=0;const M=[];z.forEach(V=>{try{const Q=V.saleDate||V.timestamp||V.ts;if(!Q)return;const I=new Date(Q);if(I>=a.start&&I<=a.end){const H=Ce(V),R=De(V);R==="telbirr"?B+=H:R==="cash"?E+=H:R==="bank"&&(A+=H),M.push(V)}}catch{}}),p({telbirr:B,cash:E,bank:A}),n(M)}catch{p({telbirr:0,cash:0,bank:0})}},[a]),o.useEffect(()=>{const h=[],v=[];for(let O=0;O<7;O++){const U=new Date(a.start);U.setDate(a.start.getDate()+O),h.push(U.toLocaleDateString(void 0,{weekday:"short",month:"numeric",day:"numeric"})),v.push(U.toISOString().slice(0,10))}const z=Object.fromEntries(v.map(O=>[O,0])),B=Object.fromEntries(v.map(O=>[O,{telbirr:0,cash:0,bank:0}])),E={},A=O=>(O==null?void 0:O.name)||(O==null?void 0:O.productName)||(O==null?void 0:O.title)||(O==null?void 0:O.item)||(O==null?void 0:O.product)||"Unknown";let M=0;j.forEach(O=>{try{const U=(O.saleDate||O.timestamp||O.ts||"").toString().slice(0,10);let r=0;if(Array.isArray(O.items)&&O.items.length?O.items.forEach(t=>{const i=Number(t.quantity??t.qty??0)||0,g=Number(t.price??0)||0,_=Number(t.subtotal??g*i??0)||0;r+=_;const P=A(t);E[P]||(E[P]={label:P,rev:0,qty:0}),E[P].rev+=_,E[P].qty+=i}):r=Number(O.total??O.totalAmount??0)||0,z.hasOwnProperty(U)&&(z[U]+=r),B.hasOwnProperty(U)){const t=De(O);t==="telbirr"?B[U].telbirr+=r:t==="cash"?B[U].cash+=r:t==="bank"&&(B[U].bank+=r)}M+=r}catch{}});const V=v.map(O=>Number((z[O]||0).toFixed(2)));W({labels:h,data:V});const Q=v.map(O=>{var U;return Number((((U=B[O])==null?void 0:U.telbirr)||0).toFixed(2))}),I=v.map(O=>{var U;return Number((((U=B[O])==null?void 0:U.cash)||0).toFixed(2))}),H=v.map(O=>{var U;return Number((((U=B[O])==null?void 0:U.bank)||0).toFixed(2))});u({labels:h,telbirr:Q,cash:I,bank:H});const R=Object.values(E).sort((O,U)=>U.rev-O.rev);w(R.slice(0,8));const ae=M/7;Y({total:M,avgDaily:ae,orders:j.length})},[j,a]);function C(h){try{return new Date(h).toLocaleDateString()}catch{return"-"}}function f(h){return Number(h||0).toLocaleString(void 0,{maximumFractionDigits:2})}function G(h){const v=String(h||"").toLowerCase();return v.includes("cash")?"Cash":v.includes("tel")||v.includes("birr")?"Mobile Money":v.includes("bank")||v.includes("transfer")?"Bank Transfer":"Other"}function Z(){const h=a.start,v=a.end,z=localStorage.getItem("bakery_app_v1"),B=z?JSON.parse(z):{},A=(Array.isArray(B.sales)?B.sales:[]).filter(I=>{const H=I.saleDate||I.timestamp||I.ts;if(!H)return!1;const R=new Date(H);return R>=h&&R<=v}),M={};A.forEach(I=>{var i;const H=I.cashierName||I.cashier||I.user||"Unknown Cashier",R=Array.isArray(I.items)?I.items:[],ae=I.hours||null,O=I.rate||null,U=Ce(I),r=G(I.paymentMethod||I.paidBy||I.method||I.payMethod||I.tender),t={employee:I.employeeName||I.employee||((i=R[0])==null?void 0:i.employee)||"-",date:I.saleDate||I.timestamp||I.ts,hours:ae,rate:O,total:U,paymentMethod:r};M[H]||(M[H]={receipts:[],totals:{Cash:0,"Mobile Money":0,"Bank Transfer":0,Other:0},subtotal:0}),M[H].receipts.push(t),M[H].totals[r]+=U,M[H].subtotal+=U});const V=Object.keys(M).map(I=>({cashier:I,cash:M[I].totals.Cash,mobile:M[I].totals["Mobile Money"],bank:M[I].totals["Bank Transfer"],subtotal:M[I].subtotal})),Q={totalCash:V.reduce((I,H)=>I+H.cash,0),totalMobile:V.reduce((I,H)=>I+H.mobile,0),totalBank:V.reduce((I,H)=>I+H.bank,0),grand:V.reduce((I,H)=>I+H.subtotal,0)};return{start:h,end:v,overview:V,byCashier:M,final:Q}}function X(){const h=Z(),v=[["Cashier","Employee","Date","Hours","Rate","Total","Payment Method"]];Object.keys(h.byCashier).forEach(M=>{h.byCashier[M].receipts.forEach(Q=>{v.push([M,Q.employee,C(Q.date),Q.hours??"",Q.rate??"",f(Q.total),Q.paymentMethod])})});const z=v.map(M=>M.map(V=>`"${String(V).replace(/"/g,'""')}"`).join(",")).join(`
`),B=new Blob([z],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(B),A=document.createElement("a");A.href=E,A.download=`Weekly_Receipts_${a.start.toISOString().slice(0,10)}_${a.end.toISOString().slice(0,10)}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(E)}o.useEffect(()=>{const h=D.current&&D.current.getContext?D.current.getContext("2d"):null;if(h){if(L.current){try{L.current.destroy()}catch{}L.current=null}const z=b.data.map((B,E)=>E%2===0?3:0);L.current=new je(h,{type:"line",data:{labels:b.labels,datasets:[{label:"Revenue",data:b.data,borderColor:"#2563eb",backgroundColor:"rgba(37,99,235,0.12)",tension:.3,fill:!0,borderWidth:2,borderDash:[5,3],pointRadius:z,pointHoverRadius:5,pointBackgroundColor:"#2563eb"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})}const v=S.current&&S.current.getContext?S.current.getContext("2d"):null;if(v){if(m.current){try{m.current.destroy()}catch{}m.current=null}m.current=new je(v,{type:"bar",data:{labels:k.labels,datasets:[{label:"TelBirr",data:k.telbirr,backgroundColor:"#3b82f6"},{label:"Cash",data:k.cash,backgroundColor:"#10b981"},{label:"Bank",data:k.bank,backgroundColor:"#f59e0b"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0}}}})}return()=>{try{L.current&&L.current.destroy()}catch{}try{m.current&&m.current.destroy()}catch{}}},[b,k]);function N(h){const v=new Date(l);v.setDate(v.getDate()+h*7),c(v.toISOString().slice(0,10))}return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“ˆ"}),e.jsx("h1",{children:"Weekely Summaries"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/daily-summary"),children:"Back to Summarry"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:"Week"}),e.jsxs("div",{className:"muted",children:[a.start.toISOString().slice(0,10)," â†’ ",a.end.toISOString().slice(0,10)]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("button",{className:"btn ghost",onClick:()=>N(-1),children:"Prev"}),e.jsx("input",{type:"date",value:l,onChange:h=>c(h.target.value)}),e.jsx("button",{className:"btn ghost",onClick:()=>N(1),children:"Next"}),e.jsx("button",{className:"btn",onClick:X,style:{marginLeft:8,background:"#0ea5e9",color:"#fff"},children:"Download CSV"})]})]}),e.jsx("div",{style:{marginTop:12},children:e.jsxs("div",{className:"summary-panel",children:[e.jsxs("div",{className:"summary-box summary-daily",style:{cursor:"default"},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ“²"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"TelBirr"}),e.jsx("div",{className:"sb-value",children:xe(y.telbirr)}),e.jsx("div",{className:"sb-desc",children:"Total for the week"})]})]}),e.jsxs("div",{className:"summary-box summary-weekly",style:{cursor:"default"},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ’µ"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Cash"}),e.jsx("div",{className:"sb-value",children:xe(y.cash)}),e.jsx("div",{className:"sb-desc",children:"Total for the week"})]})]}),e.jsxs("div",{className:"summary-box summary-monthly",style:{cursor:"default"},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ¦"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Bank / Transfer"}),e.jsx("div",{className:"sb-value",children:xe(y.bank)}),e.jsx("div",{className:"sb-desc",children:"Total for the week"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-3",children:[e.jsxs("div",{className:"rounded-lg bg-slate-100 p-3",children:[e.jsx("div",{className:"text-slate-500 text-xs",children:"Total Revenue"}),e.jsx("div",{className:"text-slate-900 font-extrabold text-lg",children:xe(d.total)})]}),e.jsxs("div",{className:"rounded-lg bg-slate-100 p-3",children:[e.jsx("div",{className:"text-slate-500 text-xs",children:"Average Daily"}),e.jsx("div",{className:"text-slate-900 font-extrabold text-lg",children:xe(d.avgDaily)})]}),e.jsxs("div",{className:"rounded-lg bg-slate-100 p-3",children:[e.jsx("div",{className:"text-slate-500 text-xs",children:"Orders"}),e.jsx("div",{className:"text-slate-900 font-extrabold text-lg",children:Number(d.orders||0).toLocaleString()})]})]}),e.jsxs("div",{className:"card",style:{marginTop:14},children:[e.jsx("h3",{className:"mb-2",children:"Revenue by Day"}),e.jsx("div",{className:"h-64",children:e.jsx("canvas",{ref:D})})]}),e.jsxs("div",{className:"card",style:{marginTop:14},children:[e.jsx("h3",{className:"mb-2",children:"Payment Method Breakdown (Daily)"}),e.jsx("div",{className:"h-64",children:e.jsx("canvas",{ref:S})})]}),e.jsxs("div",{className:"card",style:{marginTop:14},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:8},children:"Top Products (By Revenue)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(240px,1.2fr) minmax(240px,1fr)",gap:12},children:[e.jsx("div",{style:{height:280},children:e.jsx(et,{products:q})}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8fafc"},children:[e.jsx("th",{style:{padding:"8px 10px",fontSize:12,color:"#475569"},children:"Product"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:12,color:"#475569"},children:"Qty"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:12,color:"#475569"},children:"Revenue"})]})}),e.jsx("tbody",{children:q.map((h,v)=>e.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[e.jsx("td",{style:{padding:"8px 10px",fontSize:12,color:"#0f172a"},children:h.label}),e.jsx("td",{style:{padding:"8px 10px",fontSize:12,color:"#0f172a"},children:Number(h.qty||0).toLocaleString()}),e.jsx("td",{style:{padding:"8px 10px",fontSize:12,color:"#0f172a",fontWeight:700},children:Number(h.rev||0).toLocaleString()})]},h.label+v))})]})})]})]}),K&&(()=>{const h=Z();return e.jsxs("div",{className:"card",style:{marginTop:14},children:[e.jsxs("h3",{className:"mb-2",children:["Weekly Receipts Summary â€” ",a.start.toISOString().slice(0,10)," â†’ ",a.end.toISOString().slice(0,10)]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",style:{borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8fafc"},children:[e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Cashier"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Cash Total"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Mobile Money Total"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Bank Transfer Total"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Subtotal"})]})}),e.jsx("tbody",{children:h.overview.map((v,z)=>e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:v.cashier}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(v.cash)}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(v.mobile)}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(v.bank)}),e.jsx("td",{className:"px-3 py-2 text-sm font-bold text-slate-900",children:f(v.subtotal)})]},v.cashier+z))})]})}),Object.keys(h.byCashier).map((v,z)=>{const B=h.byCashier[v];return e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-base font-bold",children:["Cashier: ",v]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2",children:[e.jsxs("div",{className:"rounded bg-slate-100 p-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Cash"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f(B.totals.Cash)})]}),e.jsxs("div",{className:"rounded bg-slate-100 p-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Mobile Money"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f(B.totals["Mobile Money"])})]}),e.jsxs("div",{className:"rounded bg-slate-100 p-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Bank Transfer"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f(B.totals["Bank Transfer"])})]}),e.jsxs("div",{className:"rounded bg-slate-100 p-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Other"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f(B.totals.Other)})]})]}),e.jsx("div",{className:"overflow-x-auto mt-3",children:e.jsxs("table",{className:"min-w-full",style:{borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8fafc"},children:[e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Employee"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Hours"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Rate"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Total"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Payment Method"})]})}),e.jsx("tbody",{children:B.receipts.map((E,A)=>e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:E.employee}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:C(E.date)}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:E.hours??""}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:E.rate??""}),e.jsx("td",{className:"px-3 py-2 text-sm font-bold text-slate-900",children:f(E.total)}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:E.paymentMethod})]},A))})]})}),e.jsxs("div",{className:"mt-2 text-sm font-bold",children:["Subtotal: ",f(B.subtotal)]})]},v+z)}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-base font-bold",children:"Final Summary"}),e.jsx("div",{className:"overflow-x-auto mt-2",children:e.jsxs("table",{className:"min-w-full",style:{borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8fafc"},children:[e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Category"}),e.jsx("th",{className:"px-3 py-2 text-sm text-slate-600",children:"Amount"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:"Total Cash"}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(h.final.totalCash)})]}),e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:"Total Mobile Money"}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(h.final.totalMobile)})]}),e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:"Total Bank Transfer"}),e.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f(h.final.totalBank)})]}),e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2 text-sm font-bold text-slate-900",children:"Grand Total"}),e.jsx("td",{className:"px-3 py-2 text-sm font-bold text-slate-900",children:f(h.final.grand)})]})]})]})}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:"Prepared By: ___________________ Â  Approved By: ___________________ Â  Date: _____________"})]})]})})()]})]})}function at(s){const l=new Date(s);return l.setDate(1),l.setHours(0,0,0,0),l}function nt(s){const l=new Date(s);return l.setMonth(l.getMonth()+1,0),l.setHours(23,59,59,999),l}function _e(s){try{let l=0;return Array.isArray(s.items)&&s.items.length?s.items.forEach(c=>{const a=Number(c.subtotal??c.price*c.quantity??0)||0;l+=a}):l=Number(s.total??s.totalAmount??0)||0,l}catch{return 0}}function Ie(s){const l=[s.paymentMethod,s.paidBy,s.payment,s.method,s.payMethod,s.tender];for(const c of l){if(!c)continue;const a=String(c).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr")||a.includes("telebirr")||a.includes("telbirr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank"}if(Array.isArray(s.payments)&&s.payments.length){const c=s.payments[0];if(c&&c.method){const a=String(c.method).toLowerCase();if(a.includes("cash"))return"cash";if(a.includes("tel")||a.includes("birr"))return"telbirr";if(a.includes("bank")||a.includes("transfer"))return"bank"}}return"other"}function me(s){return s==null?"-":Number(s).toLocaleString(void 0,{maximumFractionDigits:2})+" Birr"}function rt(){var L;const s=le(),[l,c]=o.useState(()=>new Date().toISOString().slice(0,7)),a=o.useMemo(()=>{const S=new Date(l+"-01");return{start:at(S),end:nt(S)}},[l]),[y,p]=o.useState({telbirr:0,cash:0,bank:0,other:0}),[j,n]=o.useState(0),[b,W]=o.useState([]),[q,w]=o.useState([]),[k,u]=o.useState({});o.useEffect(()=>{try{const S=localStorage.getItem("bakery_app_v1"),m=S?JSON.parse(S):{},C=Array.isArray(m.sales)?m.sales:[];let f=0,G=0,Z=0,X=0,N=0;const h={},v={};C.forEach(E=>{try{const A=E.saleDate||E.timestamp||E.ts;if(!A)return;const M=new Date(A);if(M<a.start||M>a.end)return;const V=_e(E),Q=Ie(E);Q==="telbirr"?f+=V:Q==="cash"?G+=V:Q==="bank"?Z+=V:X+=V,N+=1;const I=M.toISOString().slice(0,10);h[I]=(h[I]||0)+V,Array.isArray(E.items)&&E.items.forEach(H=>{const R=H.name??H.title??H.product??"Unknown",ae=Number(H.quantity??H.qty??1)||1,O=Number(H.subtotal??H.price*H.quantity??H.price??0)||0,U=R;v[U]||(v[U]={name:U,qty:0,revenue:0}),v[U].qty+=ae,v[U].revenue+=O})}catch{}});const z=[];for(let E=new Date(a.start);E<=a.end;E.setDate(E.getDate()+1)){const A=E.toISOString().slice(0,10);z.push({date:A,value:h[A]||0})}const B=Object.values(v);B.sort((E,A)=>A.revenue-E.revenue),p({telbirr:f,cash:G,bank:Z,other:X}),n(N),W(z),w(B.slice(0,10))}catch{p({telbirr:0,cash:0,bank:0,other:0}),n(0),W([]),w([])}},[a]),o.useEffect(()=>{try{const S=localStorage.getItem("bakery_app_v1"),C=(S?JSON.parse(S):{}).monthlySummaries||{};u(C)}catch{u({})}},[]);function d(S){try{const m=localStorage.getItem("bakery_app_v1"),C=m?JSON.parse(m):{};C.monthlySummaries=S,localStorage.setItem("bakery_app_v1",JSON.stringify(C)),u(S)}catch(m){console.error("saveMonthlySummaries",m)}}function Y(){const S=new Date(l+"-01");S.setMonth(S.getMonth()-1),c(S.toISOString().slice(0,7))}function K(){const S=new Date(l+"-01");S.setMonth(S.getMonth()+1),c(S.toISOString().slice(0,7))}function T(){try{const S=localStorage.getItem("bakery_app_v1"),m=S?JSON.parse(S):{},C=Array.isArray(m.sales)?m.sales:[],f=a.start,G=a.end;let Z=0,X=0;const N={telbirr:0,cash:0,bank:0,other:0},h={};C.forEach(E=>{try{const A=E.saleDate||E.timestamp||E.ts;if(!A)return;const M=new Date(A);if(M<f||M>G)return;const V=_e(E);Z+=1,X+=V;const Q=Ie(E);Q==="telbirr"?N.telbirr+=V:Q==="cash"?N.cash+=V:Q==="bank"?N.bank+=V:N.other+=V;const I=E,H=Array.isArray(I.items)?I.items:Array.isArray(I.lines)?I.lines:Array.isArray(I.orderItems)?I.orderItems:[];if(H&&H.length)H.forEach(R=>{const ae=R.productLabel??R.label??R.name??R.title??R.product??"Item",O=Number(R.quantity??R.qty??1)||1,U=Number(R.subtotal??R.price*O??R.total??0)||0;h[ae]||(h[ae]={qty:0,revenue:0}),h[ae].qty+=O,h[ae].revenue+=U});else if(I.productLabel||I.product||I.title||I.name){const R=I.productLabel??I.product??I.title??I.name??"Item",ae=Number(I.quantity??I.qty??1)||1,O=Number(I.total??I.totalAmount??0)||0;h[R]||(h[R]={qty:0,revenue:0}),h[R].qty+=ae,h[R].revenue+=O}}catch{}});const v=l,z={month:v,generatedAt:new Date().toISOString(),totalReceipts:Z,totalAmount:X,byPayment:N,products:h},B=Object.assign({},k);B[v]=z,d(B),alert(`Saved monthly summary for ${v}`)}catch(S){console.error("generateMonthlySummary",S),alert("Failed to generate summary")}}const D=o.useMemo(()=>!b||b.length===0?0:b.reduce((m,C)=>m+(C.value||0),0)/b.length,[b]);return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ—ƒï¸"}),e.jsx("h1",{children:"Monthly Summaries"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/daily-summary"),children:"Back to Summarry"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:"Month"}),e.jsx("div",{className:"muted",children:l})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("button",{className:"btn ghost",onClick:Y,children:"Prev"}),e.jsx("input",{type:"month",value:l,onChange:S=>c(S.target.value)}),e.jsx("button",{className:"btn ghost",onClick:K,children:"Next"}),e.jsx("button",{className:"btn",onClick:T,title:"Compress and store this month's receipts",children:"Generate Summary"})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{className:"summary-panel",children:[e.jsxs("div",{className:"summary-box summary-daily",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ“²"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"TelBirr"}),e.jsx("div",{className:"sb-value",children:me(y.telbirr)}),e.jsxs("div",{className:"sb-desc",children:["Receipts: ",j]})]})]}),e.jsxs("div",{className:"summary-box summary-weekly",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ’µ"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Cash"}),e.jsx("div",{className:"sb-value",children:me(y.cash)}),e.jsxs("div",{className:"sb-desc",children:["Avg / day: ",me(D)]})]})]}),e.jsxs("div",{className:"summary-box summary-monthly",children:[e.jsx("div",{className:"sb-icon",children:"ðŸ¦"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Bank / Transfer"}),e.jsx("div",{className:"sb-value",children:me(y.bank)}),e.jsxs("div",{className:"sb-desc",children:["Top item: ",((L=q[0])==null?void 0:L.name)??"â€”"]})]})]}),e.jsxs("div",{className:"summary-box summary-total",children:[e.jsx("div",{className:"sb-icon",children:"Î£"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",children:"Total"}),e.jsx("div",{className:"sb-value",children:me(y.telbirr+y.cash+y.bank||0)}),e.jsx("div",{className:"sb-desc",children:"Combined total for the month"})]})]})]}),e.jsxs("div",{style:{marginTop:14,display:"flex",gap:12,alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{children:"Daily totals"}),e.jsx("div",{className:"mini-chart",style:{display:"flex",gap:6,alignItems:"end",height:120},children:b.map(S=>{const m=Math.max(...b.map(f=>f.value||0),1),C=Math.round((S.value||0)/m*100);return e.jsx("div",{title:`${S.date}: ${S.value||0}`,style:{flex:1,display:"flex",alignItems:"flex-end"},children:e.jsx("div",{role:"button",tabIndex:0,onClick:()=>s(`/admin/summary/daily?date=${S.date}`),onKeyDown:f=>{f.key==="Enter"&&s(`/admin/summary/daily?date=${S.date}`)},className:"mini-bar",style:{height:`${Math.max(6,C)}%`}})},S.date)})})]}),e.jsxs("div",{style:{width:350,background:"#fff",borderRadius:16,padding:20,border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:20},children:[e.jsx("span",{style:{color:"#f59e0b",fontSize:20},children:"ðŸŽ—ï¸"}),e.jsx("h4",{style:{margin:0,fontSize:16,fontWeight:700},children:"Top Selling Products"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:q.length?q.map((S,m)=>{const C=m+1;let f="#6b7280";return C===1?f="#f59e0b":C===2?f="#10b981":C===3?f="#3b82f6":C===4&&(f="#8b5cf6"),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:f,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:14,flexShrink:0},children:C}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1f2937",fontSize:15},children:S.name}),e.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:[S.qty," units sold"]})]})]}),e.jsx("div",{style:{fontWeight:700,color:"#f59e0b",fontSize:15},children:me(S.revenue)})]},S.name)}):e.jsx("div",{className:"muted",style:{textAlign:"center",padding:20},children:"No sales data yet"})})]})]}),e.jsxs("div",{style:{marginTop:18},children:[e.jsx("h4",{children:"Monthly summaries"}),e.jsx("div",{className:"month-grid",style:{marginTop:8},children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((S,m)=>{const C=new Date(l+"-01").getFullYear(),f=m+1,G=f<10?`0${f}`:`${f}`,Z=`${C}-${G}`,X=k[Z],N=X?Number(X.totalAmount||0):0;return e.jsxs("div",{className:`month-card ${l===Z?"selected":""}`,onClick:()=>c(Z),style:{cursor:"pointer"},children:[e.jsx("div",{className:"month-name",children:S}),e.jsx("div",{className:"month-val",children:me(N)})]},Z)})})]})]})]})]})}function lt(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ‘¥"}),e.jsx("h1",{children:"Users"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Users"}),e.jsx("p",{className:"muted",children:"Manage employees and roles (placeholder)."})]})]})}function it(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“¦"}),e.jsx("h1",{children:"Products"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Products"}),e.jsx("p",{className:"muted",children:"Manage product catalog (placeholder)."})]})]})}function ot(){const s="bakery_role_passwords",l="bakery_app_creds",[c,a]=o.useState(()=>{try{return JSON.parse(localStorage.getItem(s))||{admin:"",cashir:"",manager:""}}catch{return{admin:"",cashir:"",manager:""}}}),[y,p]=o.useState(()=>{try{return JSON.parse(localStorage.getItem(l))||{username:"admin",password:"admin123"}}catch{return{username:"admin",password:"admin123"}}}),[j,n]=o.useState(!1),[b,W]=o.useState("security"),q=le(),w=()=>{try{localStorage.setItem(s,JSON.stringify(c)),localStorage.setItem(l,JSON.stringify(y));try{const u=localStorage.getItem("bakery_app_auth");if(u){const d=JSON.parse(u);d.user=d.user||{},d.user.username=y.username,localStorage.setItem("bakery_app_auth",JSON.stringify(d))}}catch(u){console.warn("updating bakery_app_auth failed",u)}n(!0),setTimeout(()=>n(!1),2200)}catch(u){console.error("failed saving settings",u)}},k=({id:u,label:d,icon:Y})=>e.jsxs("button",{className:`settings-link ${b===u?"active":""}`,onClick:()=>W(u),"aria-current":b===u?"page":void 0,children:[e.jsx("span",{className:"settings-link-icon","aria-hidden":"true",children:Y}),e.jsx("span",{className:"settings-link-label",children:d})]});return e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{style:{margin:0,flex:1},children:"Settings"}),e.jsx("button",{className:"btn",onClick:()=>q("/admin"),children:"Back to Dashboard"})]}),e.jsxs("div",{className:"settings-layout",children:[e.jsxs("nav",{className:"settings-nav","aria-label":"Settings sections",children:[e.jsx(k,{id:"security",label:"Security",icon:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M12 3l7 4v5c0 5-3.5 8.5-7 9-3.5-.5-7-4-7-9V7l7-4Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M9.5 12a2.5 2.5 0 1 0 5 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx(k,{id:"notifications",label:"Notifications",icon:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M12 3c-3 0-5 2.5-5 5.5v3.5l-2 2v1h14v-1l-2-2V8.5C17 5.5 15 3 12 3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 19a2 2 0 0 0 4 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]}),e.jsxs("section",{className:"settings-content",children:[b==="security"&&e.jsxs("div",{children:[e.jsx("p",{className:"muted",children:"Manage credentials securely. Values are stored locally on this device."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,maxWidth:760},children:[e.jsxs("div",{className:"card",style:{margin:0},children:[e.jsx("h4",{style:{margin:"0 0 8px"},children:"Login Credentials"}),e.jsx("label",{style:{display:"block",margin:"8px 0",fontWeight:600},children:"Username"}),e.jsx("input",{type:"text",value:y.username,onChange:u=>p({...y,username:u.target.value})}),e.jsx("label",{style:{display:"block",margin:"8px 0",fontWeight:600},children:"Password"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{id:"login_pwd",type:"password",value:y.password,onChange:u=>p({...y,password:u.target.value}),style:{flex:1}}),e.jsx("button",{className:"btn secondary",onClick:()=>{const u=document.getElementById("login_pwd");u&&(u.type=u.type==="password"?"text":"password")},children:"Show"})]})]}),e.jsxs("div",{className:"card",style:{margin:0},children:[e.jsx("h4",{style:{margin:"0 0 8px"},children:"Role Passwords"}),["admin","cashir","manager"].map(u=>e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs("label",{style:{display:"block",margin:"6px 0",fontWeight:600},children:[u.charAt(0).toUpperCase()+u.slice(1)," password"]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{id:`pw_${u}`,type:"password",value:c[u]||"",onChange:d=>a({...c,[u]:d.target.value}),style:{flex:1}}),e.jsx("button",{className:"btn secondary",onClick:()=>{const d=document.getElementById(`pw_${u}`);d&&(d.type=d.type==="password"?"text":"password")},children:"Show"})]})]},u))]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:14},children:[e.jsx("button",{className:"btn",onClick:w,children:"Save changes"}),j&&e.jsx("span",{style:{color:"green"},children:"Saved"}),e.jsx("button",{className:"btn",style:{background:"#ef4444",boxShadow:"0 8px 20px rgba(239,68,68,0.18)"},onClick:()=>{try{localStorage.setItem("bakery_force_logout_cashier",String(Date.now())),alert("Cashier sessions will be logged out.")}catch{}},children:"Force logout cashier"})]}),e.jsxs("div",{className:"card",style:{marginTop:16},children:[e.jsx("h4",{style:{margin:"0 0 8px"},children:"Saved credentials overview"}),e.jsx("p",{className:"muted",style:{marginTop:0},children:"You can view and copy the current usernames and passwords used in the system."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,maxWidth:820},children:[e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Admin"}),e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("div",{className:"muted",style:{marginBottom:6},children:"Username"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{readOnly:!0,value:y.username||"admin",style:{flex:1,fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontSize:14}}),e.jsx("button",{className:"btn secondary",onClick:()=>{var u;(u=navigator.clipboard)==null||u.writeText(y.username||"admin")},children:"Copy"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"muted",style:{marginBottom:6},children:"Password"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{id:"ov_admin_pw",type:"password",readOnly:!0,value:y.password||"admin123",style:{flex:1,fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontSize:14}}),e.jsx("button",{className:"btn secondary",onClick:()=>{const u=document.getElementById("ov_admin_pw");u&&(u.type=u.type==="password"?"text":"password")},children:"Show"}),e.jsx("button",{className:"btn secondary",onClick:()=>{var u;(u=navigator.clipboard)==null||u.writeText(y.password||"admin123")},children:"Copy"})]})]})]}),e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Cashier"}),e.jsxs("div",{className:"muted",style:{marginBottom:6},children:["Usernames accepted: ",e.jsx("code",{children:"cashie"})," or ",e.jsx("code",{children:"cashir"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"muted",style:{marginBottom:6},children:"Password"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{id:"ov_cashier_pw",type:"password",readOnly:!0,value:c.cashir||"cashir123",style:{flex:1,fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontSize:14}}),e.jsx("button",{className:"btn secondary",onClick:()=>{const u=document.getElementById("ov_cashier_pw");u&&(u.type=u.type==="password"?"text":"password")},children:"Show"}),e.jsx("button",{className:"btn secondary",onClick:()=>{var u;(u=navigator.clipboard)==null||u.writeText(c.cashir||"cashir123")},children:"Copy"})]})]})]}),e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Inventory (Manager)"}),e.jsxs("div",{className:"muted",style:{marginBottom:6},children:["Username: ",e.jsx("code",{children:"manager"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"muted",style:{marginBottom:6},children:"Password"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{id:"ov_manager_pw",type:"password",readOnly:!0,value:c.manager||"",placeholder:"Not set",style:{flex:1,fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontSize:14}}),e.jsx("button",{className:"btn secondary",onClick:()=>{const u=document.getElementById("ov_manager_pw");u&&(u.type=u.type==="password"?"text":"password")},children:"Show"}),e.jsx("button",{className:"btn secondary",onClick:()=>{var u;(u=navigator.clipboard)==null||u.writeText(c.manager||"")},children:"Copy"})]})]})]})]})]})]}),b==="notifications"&&e.jsxs("div",{children:[e.jsx("p",{className:"muted",children:"Notification preferences"}),e.jsxs("div",{style:{maxWidth:560},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,margin:"8px 0"},children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),"Email me daily summaries"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,margin:"8px 0"},children:[e.jsx("input",{type:"checkbox"}),"Alerts for low inventory"]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("button",{className:"btn",onClick:()=>n(!0),children:"Save preferences"}),j&&e.jsx("span",{style:{marginLeft:12,color:"green"},children:"Saved"})]})]})]}),null]})]})]})}function ct(){const[s,l]=o.useState(""),[c,a]=o.useState(""),[y,p]=o.useState(!1),[j,n]=o.useState(""),[b,W]=o.useState(!1),q=le(),w=ve();function k(){return s?c?null:"Please enter your password":"Please enter your username"}function u(d){d.preventDefault(),n("");const Y=k();if(Y){n(Y);return}W(!0);const K=new URLSearchParams(w.search),T=K.get("next")||K.get("redirect")||"/admin";setTimeout(()=>{let D;try{D=JSON.parse(localStorage.getItem("bakery_role_passwords")||"null")||{admin:"",cashir:"",manager:""}}catch{D={admin:"",cashir:"",manager:""}}const L=D.cashir||"cashir123";if((s==="cashie"||s==="cashir")&&c===L){const Z={user:{username:s,name:"Cashier"},token:"cashier-token"};try{try{localStorage.setItem("bakery_app_auth_cashier",JSON.stringify(Z))}catch{}sessionStorage.setItem("bakery_app_auth",JSON.stringify(Z)),sessionStorage.setItem("bakery_user_role","cashier")}catch{}W(!1);const X=T.includes("cashier")?T:"/cashier";q(X,{replace:!0});return}let m;try{m=JSON.parse(localStorage.getItem("bakery_app_creds")||"null")||{username:"admin",password:"admin123"}}catch{m={username:"admin",password:"admin123"}}if(m.username=m.username||"admin",m.password=m.password||"admin123",s!==m.username||c!==m.password){W(!1),n(`Invalid admin credentials. Use username "${m.username}" and password "${m.password}"`);return}const f={user:{username:s,name:s||"Admin"},token:"admin-token"};try{try{localStorage.setItem("bakery_app_auth_admin",JSON.stringify(f))}catch{}sessionStorage.setItem("bakery_app_auth",JSON.stringify(f)),sessionStorage.setItem("bakery_user_role","admin")}catch{}W(!1),q(T,{replace:!0})},600)}return e.jsxs("main",{className:"auth-page min-h-screen flex flex-col items-center justify-start py-12 px-4 bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50",children:[e.jsxs("div",{className:"text-center mb-6 select-none",children:[e.jsx("h1",{className:"text-5xl sm:text-6xl font-extrabold tracking-tight bg-gradient-to-r from-orange-500 via-amber-500 to-yellow-400 bg-clip-text text-transparent drop-shadow-sm",children:"Bakery Engine"}),e.jsxs("p",{className:"mt-3 text-sm sm:text-base font-medium text-amber-700 flex flex-col sm:flex-row items-center justify-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-80",children:[e.jsx("path",{d:"M3 8l7.89 5.26a2 2 0 0 0 2.22 0L21 8"}),e.jsx("path",{d:"M21 8v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8"}),e.jsx("path",{d:"M3 8l9-6 9 6"})]}),"Crafted Daily"]}),e.jsx("span",{className:"hidden sm:inline text-amber-400",children:"â€¢"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-80",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),"Fast â€¢ Fresh â€¢ Friendly"]}),e.jsx("span",{className:"hidden sm:inline text-amber-400",children:"â€¢"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-80",children:[e.jsx("path",{d:"M4 4h16v4H4z"}),e.jsx("path",{d:"M4 12h16v8H4z"})]}),"Point of Sweet Sale"]})]})]}),e.jsxs("div",{className:"card w-full max-w-md mx-auto rounded-xl shadow-lg border border-amber-100/70 bg-white/90 backdrop-blur-sm",children:[e.jsxs("h2",{className:"mt-4 mb-2 text-xl font-bold text-amber-900 flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-9 h-9 rounded-lg bg-gradient-to-br from-orange-500 to-amber-500 text-white shadow",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4 8 5.79 8 8s1.79 4 4 4z"}),e.jsx("path",{d:"M6 20v-2c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v2"})]})}),"Sign In"]}),e.jsxs("form",{onSubmit:u,"aria-label":"Login form",className:"px-4 pb-4",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium text-amber-900",children:"Username"}),e.jsx("input",{id:"username",name:"username",type:"text",value:s,onChange:d=>l(d.target.value),required:!0,autoComplete:"username",className:"w-full mt-1 mb-3 px-3 py-2 rounded-md border border-amber-200 focus:outline-none focus:ring-2 focus:ring-orange-400/70 focus:border-orange-400 text-[15px] bg-white/70"}),e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-amber-900",children:"Password"}),e.jsxs("div",{className:"relative mt-1 mb-3",children:[e.jsx("input",{id:"password",name:"password",type:y?"text":"password",value:c,onChange:d=>a(d.target.value),required:!0,autoComplete:"current-password",className:"w-full px-3 py-2 pr-10 rounded-md border border-amber-200 focus:outline-none focus:ring-2 focus:ring-orange-400/70 focus:border-orange-400 text-[15px] bg-white/70"}),e.jsx("button",{type:"button",onClick:()=>p(d=>!d),"aria-label":y?"Hide password":"Show password",className:"absolute inset-y-0 right-2 inline-flex items-center justify-center px-2 text-amber-700 hover:text-amber-900 focus:outline-none focus:ring-2 focus:ring-orange-400 rounded",children:y?e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 20C7 20 2.73 16.11 1 12c.74-1.64 1.76-3.12 3-4.38"}),e.jsx("path",{d:"M10.58 10.58a2 2 0 0 0 2.84 2.84"}),e.jsx("path",{d:"M23 1 1 23"})]}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-amber-800",children:[e.jsx("input",{type:"checkbox",name:"remember",className:"rounded border-amber-300 text-orange-600 focus:ring-orange-400"}),e.jsx("span",{children:"Remember me"})]})}),j&&e.jsx("div",{className:"text-red-600 text-sm font-medium mb-3",children:j}),e.jsx("button",{type:"submit",disabled:b,className:"w-full inline-flex justify-center items-center gap-2 font-semibold px-4 py-2.5 rounded-lg bg-gradient-to-r from-orange-500 via-amber-500 to-yellow-400 text-white shadow hover:shadow-md hover:brightness-105 focus:outline-none focus:ring-2 focus:ring-orange-400 disabled:opacity-60 disabled:cursor-not-allowed transition",children:b?e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",strokeOpacity:"0.25"}),e.jsx("path",{d:"M12 2a10 10 0 0 1 10 10"})]}),"Signing inâ€¦"]}):e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M12 5l7 7-7 7"})]}),"Sign In"]})})]})]})]})}function Me(){try{const s=sessionStorage.getItem("bakery_app_auth")||localStorage.getItem("bakery_app_auth")||localStorage.getItem("bakery_app_auth_cashier"),l=sessionStorage.getItem("bakery_user_role")||localStorage.getItem("bakery_user_role");if(!s)return e.jsx(ye,{to:"/login?next=/cashier",replace:!0});if(l==="cashier")return e.jsx(we,{});try{const c=JSON.parse(s);if(c&&c.token==="cashier-token")return e.jsx(we,{})}catch{}return e.jsx(ye,{to:"/login?next=/cashier",replace:!0})}catch{return e.jsx(ye,{to:"/login?next=/admin/cashier",replace:!0})}}function dt(){const s=le(),[l,c]=o.useState("daily"),[a,y]=o.useState(new Date),[p,j]=o.useState([]),[n,b]=o.useState({desc:"",amount:"",category:"General"}),[W,q]=o.useState(!1);o.useEffect(()=>{try{const D=localStorage.getItem("bakery_admin_expenses");D&&j(JSON.parse(D))}catch(D){console.error(D)}},[]);const w=D=>{j(D),localStorage.setItem("bakery_admin_expenses",JSON.stringify(D))},k=()=>{if(!n.desc||!n.amount)return;const D={id:Date.now(),...n,amount:Number(n.amount),date:new Date().toISOString()};w([D,...p]),b({desc:"",amount:"",category:"General"}),q(!1)},u=D=>{const L=new Date(a);l==="daily"?L.setDate(L.getDate()+D):l==="weekly"?L.setDate(L.getDate()+D*7):l==="monthly"&&L.setMonth(L.getMonth()+D),y(L)},d=()=>{if(l==="daily")return a.toDateString();if(l==="weekly"){const D=new Date(a);D.setDate(a.getDate()-a.getDay());const L=new Date(D);return L.setDate(D.getDate()+6),`${D.toLocaleDateString()} - ${L.toLocaleDateString()}`}if(l==="monthly")return a.toLocaleString("default",{month:"long",year:"numeric"})},K=p.filter(D=>{const L=new Date(D.date);if(l==="daily")return L.toDateString()===a.toDateString();if(l==="weekly"){const S=new Date(a);S.setDate(a.getDate()-a.getDay()),S.setHours(0,0,0,0);const m=new Date(S);return m.setDate(S.getDate()+6),m.setHours(23,59,59,999),L>=S&&L<=m}else if(l==="monthly")return L.getMonth()===a.getMonth()&&L.getFullYear()===a.getFullYear();return!0}),T=K.reduce((D,L)=>D+(L.amount||0),0);return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ¢"}),e.jsx("h1",{children:"Admin Expenses"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/expenses"),children:"Back to Expenses"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{className:"tabs",style:{display:"flex",gap:10},children:[e.jsx("button",{className:`btn ${l==="daily"?"":"secondary"}`,onClick:()=>{c("daily"),y(new Date)},children:"Daily"}),e.jsx("button",{className:`btn ${l==="weekly"?"":"secondary"}`,onClick:()=>{c("weekly"),y(new Date)},children:"Weekly"}),e.jsx("button",{className:`btn ${l==="monthly"?"":"secondary"}`,onClick:()=>{c("monthly"),y(new Date)},children:"Monthly"})]}),e.jsx("button",{className:"btn",onClick:()=>q(!W),children:W?"Cancel":"+ Add Expense"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:16,marginBottom:20},children:[e.jsx("button",{className:"btn secondary",onClick:()=>u(-1),children:"â—€ Prev"}),e.jsx("div",{style:{fontWeight:"bold",fontSize:16,minWidth:200,textAlign:"center"},children:d()}),e.jsx("button",{className:"btn secondary",onClick:()=>u(1),children:"Next â–¶"})]}),W&&e.jsxs("div",{style:{background:"#f8fafc",padding:16,borderRadius:8,marginBottom:20,border:"1px solid #e2e8f0"},children:[e.jsx("h4",{style:{marginTop:0},children:"New Expense"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Description"}),e.jsx("input",{value:n.desc,onChange:D=>b({...n,desc:D.target.value}),placeholder:"e.g. Office Supplies"})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Amount (Birr)"}),e.jsx("input",{type:"number",value:n.amount,onChange:D=>b({...n,amount:D.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:n.category,onChange:D=>b({...n,category:D.target.value}),children:[e.jsx("option",{children:"General"}),e.jsx("option",{children:"Utilities"}),e.jsx("option",{children:"Maintenance"}),e.jsx("option",{children:"Salary"}),e.jsx("option",{children:"Rent"}),e.jsx("option",{children:"Other"})]})]})]}),e.jsx("button",{className:"btn",style:{marginTop:10},onClick:k,children:"Save Expense"})]}),e.jsx("div",{className:"summary-box",style:{background:"#f1f5f9",color:"#334155",marginBottom:20,boxShadow:"none",border:"1px solid #e2e8f0"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsxs("div",{className:"sb-title",children:["Total ",l.charAt(0).toUpperCase()+l.slice(1)," Expenses"]}),e.jsxs("div",{className:"sb-value",style:{color:"#0f172a"},children:[T.toLocaleString(void 0,{minimumFractionDigits:2})," Birr"]})]})}),e.jsx("div",{className:"expense-list",children:K.length===0?e.jsx("p",{className:"muted",style:{textAlign:"center",padding:20},children:"No expenses found for this period."}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #f1f5f9",textAlign:"left"},children:[e.jsx("th",{style:{padding:10},children:"Date"}),e.jsx("th",{style:{padding:10},children:"Description"}),e.jsx("th",{style:{padding:10},children:"Category"}),e.jsx("th",{style:{padding:10,textAlign:"right"},children:"Amount"}),e.jsx("th",{style:{padding:10}})]})}),e.jsx("tbody",{children:K.map(D=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:10},children:new Date(D.date).toLocaleDateString()}),e.jsx("td",{style:{padding:10},children:D.desc}),e.jsx("td",{style:{padding:10},children:e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 8px",borderRadius:4,fontSize:12},children:D.category})}),e.jsx("td",{style:{padding:10,textAlign:"right",fontWeight:"bold"},children:Number(D.amount).toLocaleString()}),e.jsx("td",{style:{padding:10,textAlign:"right"},children:e.jsx("button",{className:"btn ghost",style:{padding:"4px 8px",fontSize:12,color:"#ef4444"},onClick:()=>{confirm("Delete this expense?")&&w(p.filter(L=>L.id!==D.id))},children:"Delete"})})]},D.id))})]})})]})]})}function mt(){const s=le();return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ“¦"}),e.jsx("h1",{children:"Inventory Expenses"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/expenses"),children:"Back to Expenses"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Inventory Expense Analysis"}),e.jsx("p",{className:"muted",children:"Details about inventory expenses will go here."})]})]})}function ht(){const s=le(),[l,c]=o.useState([]),[a,y]=o.useState([]),[p,j]=o.useState({}),[n,b]=o.useState(0),[W,q]=o.useState(0),[w,k]=o.useState(!1);o.useEffect(()=>{try{const r=localStorage.getItem("bakery_employees"),t=r?JSON.parse(r):[];c(Array.isArray(t)?t:[]);const i=Array.isArray(t)?t.filter(_=>(_.paymentCycle||"monthly")==="weekly").reduce((_,P)=>_+Number(P.salary||0),0):0,g=Array.isArray(t)?t.filter(_=>(_.paymentCycle||"monthly")==="monthly").reduce((_,P)=>_+Number(P.salary||0),0):0;b(i),q(g)}catch{b(0),q(0),c([])}try{const r=localStorage.getItem("bakery_employee_payments"),t=r?JSON.parse(r):[];y(Array.isArray(t)?t:[])}catch{y([])}try{const r=localStorage.getItem("bakery_employee_cycles"),t=r?JSON.parse(r):{};j(t&&typeof t=="object"?t:{})}catch{j({})}},[]);const u=r=>{j(r);try{localStorage.setItem("bakery_employee_cycles",JSON.stringify(r))}catch{}},d=r=>{y(r);try{localStorage.setItem("bakery_employee_payments",JSON.stringify(r))}catch{}};function Y(r){return!r||typeof r!="string"?r||"â€”":r.length<=12?r:`${r.slice(0,6)}â€¦${r.slice(-4)}`}function K(r){try{const t=new Date,g=new Date(r)-t;return Math.ceil(g/(24*60*60*1e3))}catch{return 0}}function T(r){const t=new Date(r.period_start);return(r.payment_type||"monthly")==="weekly"?G(t,6):Z(t)}function D(r){const t=new Date(r.period_start);return(r.payment_type||"monthly")==="weekly"?G(t,7):X(t)}function L(r,t,i){return Math.max(t,Math.min(i,r))}function S(r,t){try{const i=new Date(r),g=new Date(t);return Math.floor((g.setHours(0,0,0,0)-i.setHours(0,0,0,0))/(24*60*60*1e3))+1}catch{return 0}}function m(r,t,i){try{const g=new Date(t),_=new Date(i),P=new Date(r),$=S(t,i);if($<=0)return 0;const ee=new Date(L(P.setHours(0,0,0,0),g.setHours(0,0,0,0),_.setHours(0,0,0,0))),te=S(g.toISOString(),ee.toISOString());return L(te,0,$)}catch{return 0}}function C(r,t,i){const g=S(r.period_start,r.period_end);if(g<=0)return 0;const P=m(i,r.period_start,r.period_end)/g,$=Number(t||0)*P,ee=Number(r.bonuses||0)*P,te=Number(r.deductions||0)*P;return Math.max(0,$+ee-te)}function f(r){const t=Date.now().toString(36).toUpperCase(),i=(r??"").toString().slice(-2).padStart(2,"0");return`PS-${t}${i}`}function G(r,t){const i=new Date(r);return i.setDate(i.getDate()+t),i}function Z(r){return new Date(r.getFullYear(),r.getMonth()+1,0)}function X(r){const t=r.getFullYear(),i=r.getMonth(),g=r.getDate(),_=new Date(t,i+1,g);return _.getMonth()!==(i+1)%12?new Date(t,i+2,0):_}function N(r){const t=r.paymentCycle||"monthly",i=new Date,g=t==="weekly"?G(i,6):Z(i),_=t==="weekly"?G(i,7):X(i);return{employeeId:r.id,payment_type:t,period_start:i.toISOString(),period_end:g.toISOString(),payment_due_date:_.toISOString(),hours:0,rate:Number(r.salary||0),deductions:0,bonuses:0,status:"Pending",payslipId:null,audit:[]}}function h(r,t){const i=Number(t||0);return Math.max(0,i+Number(r.bonuses||0)-Number(r.deductions||0))}function v(r){const t=new Date,i=new Date(r.payment_due_date);return t<i?"Pending":t.toDateString()===i.toDateString()?"Due":"Overdue"}function z(r){const t=r.payment_type||"monthly",i=new Date(r.period_end),g=G(i,1),_=t==="weekly"?G(g,6):Z(g),P=t==="weekly"?G(g,7):X(g);return{employeeId:r.employeeId,payment_type:t,period_start:g.toISOString(),period_end:_.toISOString(),payment_due_date:P.toISOString(),hours:0,rate:r.rate,deductions:0,bonuses:0,status:"Pending",payslipId:null,audit:[]}}o.useEffect(()=>{if(!l.length)return;const r={...p};let t=!1;l.forEach(i=>{r[i.id]||(r[i.id]={current:N(i),history:[]},t=!0)}),t&&u(r)},[l]);const B=o.useMemo(()=>{const r={...p};return Object.keys(r).forEach(t=>{const i=r[t];if(!i||!i.current)return;let g=i.current;if(g.status==="Paid"||g.status==="Early Paid"){const P=i.history&&i.history[0]&&i.history[0].payslipId===g.payslipId?i.history:[g,...i.history||[]],$=z(g);r[t]={current:$,history:P},g=$}if(g.status!=="Pending"){const _=v(g);g.status!==_&&(r[t]={...r[t],current:{...g,status:_}})}}),JSON.stringify(r)!==JSON.stringify(p)&&u(r),r},[p]),E=o.useMemo(()=>{const r=new Date,t=new Date(r.getFullYear(),r.getMonth(),1),i=new Date(r.getFullYear(),r.getMonth()+1,1);let g=0,_=0,P=0;return l.forEach($=>{const ee=B[$.id];if(!ee)return;(ee.history||[]).forEach(re=>{var se;const x=(se=re.audit)==null?void 0:se.find(ie=>ie.action==="pay"),F=x==null?void 0:x.date,J=Number((x==null?void 0:x.net)||0);if(F){const ie=new Date(F);ie>=t&&ie<i&&(g+=J)}});const te=ee.current;if(te){te.status==="Overdue"&&(_+=1);const re=new Date(te.payment_due_date),x=re-r<=7*24*60*60*1e3&&re>=r;(te.status==="Pending"||te.status==="Due"||x)&&(P+=1)}}),{totalPaidThisMonth:g,overdueCount:_,upcomingCount:P}},[B,l]);function A(r){var J,se;const t=(J=B[r])==null?void 0:J.current;if(!t)return;const i=l.find(ie=>ie.id===r),g=new Date(t.payment_due_date),_=new Date,P=h(t,i?i.salary:0),$=_<g?"Early Paid":"Paid",ee=f(r),te={...t,status:$,payslipId:ee,audit:[...t.audit||[],{action:"pay",net:P,date:_.toISOString()}]},re=z(te),x={...B,[r]:{current:re,history:[te,...((se=B[r])==null?void 0:se.history)||[]]}};u(x);const F={id:`LOG-${r}-${Date.now()}`,payslipId:ee,employeeId:r,employeeName:(i==null?void 0:i.name)||"Unknown",amount:P,payment_type:t.payment_type||(i==null?void 0:i.paymentCycle)||"monthly",period_start:t.period_start,period_end:t.period_end,paid_at:_.toISOString()};d([F,...a])}function M(r){const t=B[r];if(!t)return;const[i,...g]=t.history||[];if(!i)return;const _=new Date,P=(i.audit||[]).filter(re=>re.action!=="pay"),$=(i.audit||[]).some(re=>re.action==="pay-partial");let ee={...i,status:"Pending",payslipId:null,audit:[...P,{action:"undo",date:_.toISOString()}]};if($){const re=T(i).toISOString(),x=D(i).toISOString();ee={...ee,period_end:re,payment_due_date:x}}const te={...B,[r]:{current:ee,history:g}};if(u(te),i.payslipId){const re=a.filter(x=>x.payslipId!==i.payslipId);d(re)}}function V(r){const t=B[r];if(!t)return;const i=t.current;if(!i||["Paid","Early Paid"].includes(i.status))return;const g=l.find(F=>F.id===r),_=new Date,P=C(i,g?g.salary:0,_),$=f(r),ee={...i,period_end:_.toISOString(),payment_due_date:_.toISOString(),status:"Early Paid",payslipId:$,audit:[...i.audit||[],{action:"pay-partial",net:P,date:_.toISOString()}]},te=z(ee),re={...B,[r]:{current:te,history:[ee,...t.history||[]]}};u(re);const x={id:`LOG-${r}-${Date.now()}`,payslipId:$,employeeId:r,employeeName:(g==null?void 0:g.name)||"Unknown",amount:P,payment_type:i.payment_type||(g==null?void 0:g.paymentCycle)||"monthly",period_start:i.period_start,period_end:ee.period_end,paid_at:_.toISOString(),prorated:!0};d([x,...a])}function Q(r){const t=r==="weekly"?"weekly":"monthly",i=`Are you sure you want to pay all ${t} employees now?`;if(!window.confirm(i))return;const g=new Date,_={...B},P=[];let $=0,ee=0;l.forEach(te=>{const re=_[te.id];if(!re||!re.current)return;const x=re.current;if(x.payment_type!==t||["Paid","Early Paid"].includes(x.status))return;const F=h(x,te?te.salary:0),J=new Date(x.payment_due_date),se=g<J?"Early Paid":"Paid",ie=f(te.id),ce={...x,status:se,payslipId:ie,audit:[...x.audit||[],{action:"pay",net:F,date:g.toISOString()}]},be=z(ce);_[te.id]={current:be,history:[ce,...re.history||[]]},P.push({id:`LOG-${te.id}-${Date.now()}-${$}`,payslipId:ie,employeeId:te.id,employeeName:(te==null?void 0:te.name)||"Unknown",amount:F,payment_type:x.payment_type||(te==null?void 0:te.paymentCycle)||t,period_start:x.period_start,period_end:x.period_end,paid_at:g.toISOString()}),$+=1,ee+=F}),u(_),P.length&&d([...P,...a]),window.alert(`Paid ${$} ${t} employee(s) totaling ${ee.toLocaleString()} Birr.`)}function I(r,t,i){const g=B[r];if(!g)return;const _=g.current;if(["Paid","Early Paid"].includes(_.status))return;const P={...B,[r]:{...g,current:{..._,[t]:i}}};u(P)}const H=a.filter(r=>{const t=l.find(g=>g.id===r.employeeId);return(t&&t.paymentCycle?t.paymentCycle:"monthly")==="weekly"}),R=a.filter(r=>{const t=l.find(g=>g.id===r.employeeId);return(t&&t.paymentCycle?t.paymentCycle:"monthly")==="monthly"}),ae=H.reduce((r,t)=>r+Number(t.amount||0),0),O=R.reduce((r,t)=>r+Number(t.amount||0),0),U=o.useMemo(()=>(a||[]).map(r=>({...r,employee:l.find(t=>t.id===r.employeeId)||null})),[a,l]);return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("img",{src:"/image/sina logo2.png",alt:"Brand",style:{height:36}}),e.jsx("h1",{children:"Employee Payments Tracker"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/reports"),children:"Back to Payment Tracker"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginBottom:10},children:[e.jsx("button",{className:"btn",onClick:()=>Q("weekly"),style:{background:"#0ea5e9",color:"#fff"},children:"Pay All Weekly"}),e.jsx("button",{className:"btn",onClick:()=>Q("monthly"),style:{background:"#16a34a",color:"#fff"},children:"Pay All Monthly"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:14},children:[e.jsxs("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#0ea5e9,#2563eb)",color:"#ffffff"},children:[e.jsx("div",{className:"sb-icon",children:"ðŸ‘¥"}),e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#ffffff"},children:"Totals"}),e.jsxs("div",{className:"sb-value",style:{color:"#ffffff",fontWeight:800},children:[(n+W).toLocaleString()," Birr"]}),e.jsxs("div",{className:"sb-desc",style:{color:"#e2e8f0"},children:["Weekly: ",n.toLocaleString()," â€¢ Monthly: ",W.toLocaleString()]})]})]}),e.jsx("div",{className:"summary-box",style:{background:"#ffffff",border:"1px solid #e2e8f0",color:"#0f172a"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#0f172a",fontSize:14},children:"Paid So Far"}),e.jsxs("div",{className:"sb-value",style:{color:"#0f172a",fontWeight:800,fontSize:16},children:[(ae+O).toLocaleString()," Birr"]}),e.jsxs("div",{className:"sb-desc",style:{color:"#334155",fontSize:13},children:["Weekly: ",H.length," â€¢ Monthly: ",R.length]})]})}),e.jsx("div",{className:"summary-box",style:{background:"#16a34a",color:"#ffffff"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#ffffff"},children:"Total Paid This Month"}),e.jsxs("div",{className:"sb-value",style:{color:"#ffffff",fontWeight:800},children:[E.totalPaidThisMonth.toLocaleString()," Birr"]}),e.jsx("div",{className:"sb-desc",style:{color:"#dcfce7"},children:"Archival cycles paid in current month"})]})}),e.jsx("div",{className:"summary-box",style:{background:"#dc2626",color:"#ffffff"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#ffffff"},children:"Overdue Payments"}),e.jsx("div",{className:"sb-value",style:{color:"#ffffff",fontWeight:800},children:E.overdueCount}),e.jsx("div",{className:"sb-desc",style:{color:"#fee2e2"},children:"Current cycles marked overdue"})]})}),e.jsx("div",{className:"summary-box",style:{background:"#f59e0b",color:"#ffffff"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#ffffff"},children:"Upcoming Payments"}),e.jsx("div",{className:"sb-value",style:{color:"#ffffff",fontWeight:800},children:E.upcomingCount}),e.jsx("div",{className:"sb-desc",style:{color:"#ffedd5"},children:"Due soon or pending within 7 days"})]})})]}),e.jsx("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(280px,1fr))",gap:12},children:l.map(r=>{const t=B[r.id];if(!t)return null;const i=t.current,g=["Paid","Early Paid"].includes(i.status),_=K(i.payment_due_date),P=i.status==="Pending"?"#64748b":i.status==="Due"?"#b45309":i.status==="Overdue"?"#b91c1c":i.status==="Early Paid"?"#f59e0b":"#16a34a";return e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("div",{style:{fontWeight:700},children:r.name}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:8,padding:"6px 10px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:[e.jsx("span",{style:{fontSize:12,color:"#64748b"},children:"Salary"}),e.jsxs("span",{style:{fontSize:13,color:"#2563eb",fontWeight:800},children:[Number(r.salary||0).toLocaleString()," Birr"]})]})]}),e.jsx("span",{style:{fontSize:12,background:"#f1f5f9",color:P,padding:"2px 8px",borderRadius:6},children:i.status})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:8,marginTop:8,fontSize:12,color:"#475569"},children:[e.jsxs("div",{children:["Start: ",e.jsx("strong",{children:new Date(i.period_start).toLocaleDateString()})]}),e.jsxs("div",{children:["End: ",e.jsx("strong",{children:new Date(i.period_end).toLocaleDateString()})]}),e.jsxs("div",{children:["Due: ",e.jsx("strong",{children:new Date(i.payment_due_date).toLocaleDateString()}),e.jsx("span",{style:{marginLeft:6,color:"#dc2626",fontWeight:800},children:isNaN(_)?"":`${_}d`})]}),e.jsxs("div",{children:["Type: ",e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 6px",borderRadius:4},children:i.payment_type})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:8,marginTop:10},children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{style:{fontSize:12},children:"Bonuses"}),e.jsx("input",{type:"number",disabled:g,value:i.bonuses,onChange:$=>I(r.id,"bonuses",Number($.target.value))})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{style:{fontSize:12},children:"Deductions"}),e.jsx("input",{type:"number",disabled:g,value:i.deductions,onChange:$=>I(r.id,"deductions",Number($.target.value))})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10},children:[e.jsxs("div",{style:{fontSize:13,color:"#0f172a"},children:["Net: ",e.jsxs("strong",{children:[h(i,r.salary).toLocaleString()," Birr"]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn",disabled:g,onClick:()=>A(r.id),style:{background:"#1d4ed8",color:"#fff"},children:"Pay Now"}),e.jsx("button",{className:"btn",disabled:g,onClick:()=>V(r.id),style:{background:"#0ea5e9",color:"#fff"},children:"Pay To Date"}),e.jsx("button",{className:"btn secondary",disabled:!t.history||t.history.length===0,onClick:()=>M(r.id),children:"Undo"})]})]}),e.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#334155"},children:["Accrued today: ",e.jsxs("strong",{style:{color:"#0f172a"},children:[C(i,r.salary,new Date).toLocaleString()," Birr"]})]}),t.history&&t.history.length>0&&e.jsx("div",{style:{marginTop:8},children:e.jsxs("small",{style:{color:"#64748b",fontSize:12},children:["Previous Periods: ",t.history.length," â€¢ Last payslip: ",Y(t.history[0].payslipId)||"â€”"]})})]},r.id)})}),e.jsxs("div",{className:"card",style:{marginTop:18},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("h2",{style:{margin:0,fontSize:18},children:"Payments History"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsxs("small",{style:{color:"#64748b",fontSize:13},children:["Entries: ",U.length]}),e.jsx("button",{className:"btn secondary",onClick:()=>k(r=>!r),children:w?"Expand":"Collapse"})]})]}),w?e.jsx("div",{style:{padding:12,color:"#64748b",fontSize:13},children:"History collapsed."}):U.length===0?e.jsx("div",{style:{padding:12,color:"#64748b",fontSize:13},children:"No payments recorded yet. Use Pay Now to record payments."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{textAlign:"left",background:"#f8fafc"},children:[e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Date"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Employee"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Type"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Period"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Amount"}),e.jsx("th",{style:{padding:"8px 10px",fontSize:13,color:"#475569"},children:"Payslip"})]})}),e.jsx("tbody",{children:U.slice(0,50).map(r=>{var _;const t=r.paid_at?new Date(r.paid_at).toLocaleString():"-",i=r.employeeName||((_=r.employee)==null?void 0:_.name)||"â€”",g=r.period_start&&r.period_end?`${new Date(r.period_start).toLocaleDateString()} â†’ ${new Date(r.period_end).toLocaleDateString()}`:"â€”";return e.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[e.jsx("td",{style:{padding:"8px 10px",fontSize:13,color:"#0f172a"},children:t}),e.jsx("td",{style:{padding:"8px 10px",fontSize:13,color:"#0f172a"},children:i}),e.jsx("td",{style:{padding:"8px 10px"},children:e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 6px",borderRadius:4,fontSize:12},children:r.payment_type})}),e.jsx("td",{style:{padding:"8px 10px",fontSize:13,color:"#334155"},children:g}),e.jsxs("td",{style:{padding:"8px 10px",fontWeight:700,color:"#0f172a",fontSize:14},children:[Number(r.amount||0).toLocaleString()," Birr"]}),e.jsx("td",{style:{padding:"8px 10px",fontSize:13,color:"#64748b"},children:Y(r.payslipId)})]},r.id)})})]})})]})]})]})}function ut(){const s=le(),[l,c]=o.useState("monthly"),[a,y]=o.useState(new Date),[p,j]=o.useState([]),[n,b]=o.useState("all"),[W,q]=o.useState("all");o.useEffect(()=>{try{const m=localStorage.getItem("bakery_admin_expenses"),C=m?JSON.parse(m):[];j(Array.isArray(C)?C:[])}catch{j([])}},[]);const w=m=>{j(m);try{localStorage.setItem("bakery_admin_expenses",JSON.stringify(m))}catch{}},k=m=>{const C=new Date(a);l==="daily"?C.setDate(C.getDate()+m):l==="weekly"?C.setDate(C.getDate()+m*7):l==="monthly"&&C.setMonth(C.getMonth()+m),y(C)},u=m=>{const C=new Date(m);if(l==="daily")return C.toDateString()===a.toDateString();if(l==="weekly"){const f=new Date(a);f.setDate(a.getDate()-a.getDay()),f.setHours(0,0,0,0);const G=new Date(f);return G.setDate(f.getDate()+6),G.setHours(23,59,59,999),C>=f&&C<=G}return l==="monthly"?C.getMonth()===a.getMonth()&&C.getFullYear()===a.getFullYear():!0},d=["all","General","Utilities","Maintenance","Salary","Rent","Other"],Y=(p||[]).filter(m=>u(m.date)).filter(m=>n==="all"?!0:n==="paid"?!!m.paid:!m.paid).filter(m=>W==="all"?!0:m.category===W),K=(p||[]).filter(m=>u(m.date)).reduce((m,C)=>m+Number(C.amount||0),0),T=(p||[]).filter(m=>u(m.date)&&m.paid).reduce((m,C)=>m+Number(C.amount||0),0),D=K-T,L=m=>{const C=p.map(f=>{if(f.id!==m)return f;const G=!f.paid;return{...f,paid:G,paidDate:G?new Date().toISOString():null}});w(C)},S=()=>{if(l==="daily")return a.toDateString();if(l==="weekly"){const m=new Date(a);m.setDate(a.getDate()-a.getDay());const C=new Date(m);return C.setDate(m.getDate()+6),`${m.toLocaleDateString()} - ${C.toLocaleDateString()}`}return l==="monthly"?a.toLocaleString("default",{month:"long",year:"numeric"}):""};return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"logo",children:"ðŸ§¾"}),e.jsx("h1",{children:"Expense Payments Tracker"}),e.jsx("button",{className:"btn",style:{marginLeft:12},onClick:()=>s("/admin/reports"),children:"Back to Payment Tracker"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{style:{display:"flex",gap:8},children:["daily","weekly","monthly"].map(m=>e.jsx("button",{className:`btn ${l===m?"":"secondary"}`,onClick:()=>{c(m),y(new Date)},style:l===m?{background:"#1d4ed8",color:"#ffffff",border:"1px solid #1e40af"}:{background:"#f1f5f9",color:"#0f172a",border:"1px solid #cbd5e1"},children:m[0].toUpperCase()+m.slice(1)},m))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{className:"btn secondary",onClick:()=>k(-1),style:{background:"#e2e8f0",color:"#0f172a",border:"1px solid #cbd5e1"},children:"â—€ Prev"}),e.jsx("div",{style:{fontWeight:"bold",fontSize:16,minWidth:200,textAlign:"center"},children:S()}),e.jsx("button",{className:"btn secondary",onClick:()=>k(1),style:{background:"#e2e8f0",color:"#0f172a",border:"1px solid #cbd5e1"},children:"Next â–¶"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:12,marginBottom:16},children:[e.jsx("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#dbeafe,#93c5fd)"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#0f172a",fontWeight:700},children:"Total"}),e.jsxs("div",{className:"sb-value",style:{color:"#0f172a",fontWeight:800,fontSize:22},children:[K.toLocaleString(void 0,{minimumFractionDigits:2})," Birr"]})]})}),e.jsx("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#bbf7d0,#86efac)"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#0f172a",fontWeight:700},children:"Paid"}),e.jsxs("div",{className:"sb-value",style:{color:"#0f172a",fontWeight:800,fontSize:22},children:[T.toLocaleString(void 0,{minimumFractionDigits:2})," Birr"]})]})}),e.jsx("div",{className:"summary-box",style:{background:"linear-gradient(135deg,#fecaca,#fca5a5)"},children:e.jsxs("div",{className:"sb-meta",children:[e.jsx("div",{className:"sb-title",style:{color:"#0f172a",fontWeight:700},children:"Unpaid"}),e.jsxs("div",{className:"sb-value",style:{color:"#0f172a",fontWeight:800,fontSize:22},children:[D.toLocaleString(void 0,{minimumFractionDigits:2})," Birr"]})]})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,flexWrap:"wrap"},children:[e.jsx("span",{style:{fontSize:12,color:"#64748b",fontWeight:600},children:"Status:"}),["all","paid","unpaid"].map(m=>e.jsx("button",{className:"btn",onClick:()=>b(m),style:{padding:"6px 10px",fontSize:12,borderRadius:6,border:"1px solid #cbd5e1",background:n===m?"#1d4ed8":"#ffffff",color:n===m?"#ffffff":"#334155"},children:m==="all"?"All":m==="paid"?"Paid":"Unpaid"},m)),e.jsx("span",{style:{fontSize:12,color:"#64748b",fontWeight:600},children:"Category:"}),e.jsx("select",{value:W,onChange:m=>q(m.target.value),style:{padding:"6px 10px",border:"1px solid #cbd5e1",borderRadius:6,fontSize:12,background:"#fff"},children:d.map(m=>e.jsx("option",{value:m,children:m},m))}),e.jsxs("span",{style:{fontSize:12,color:"#475569"},children:["Showing ",Y.length]})]}),Y.length===0?e.jsx("p",{className:"muted",style:{textAlign:"center",padding:20},children:"No expenses found for this period."}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #f1f5f9",textAlign:"left"},children:[e.jsx("th",{style:{padding:10},children:"Date"}),e.jsx("th",{style:{padding:10},children:"Description"}),e.jsx("th",{style:{padding:10},children:"Category"}),e.jsx("th",{style:{padding:10,textAlign:"right"},children:"Amount"}),e.jsx("th",{style:{padding:10},children:"Status"}),e.jsx("th",{style:{padding:10,textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:Y.map(m=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:10},children:new Date(m.date).toLocaleDateString()}),e.jsx("td",{style:{padding:10},children:m.desc}),e.jsx("td",{style:{padding:10},children:e.jsx("span",{style:{background:"#eef2ff",color:"#4f46e5",padding:"2px 8px",borderRadius:4,fontSize:12},children:m.category})}),e.jsx("td",{style:{padding:10,textAlign:"right",fontWeight:"bold"},children:Number(m.amount).toLocaleString()}),e.jsx("td",{style:{padding:10},children:m.paid?e.jsx("span",{style:{background:"#dcfce7",color:"#166534",padding:"2px 8px",borderRadius:4,fontSize:12},children:"Paid"}):e.jsx("span",{style:{background:"#fee2e2",color:"#b91c1c",padding:"2px 8px",borderRadius:4,fontSize:12},children:"Unpaid"})}),e.jsx("td",{style:{padding:10,textAlign:"right"},children:e.jsx("button",{className:"btn",style:{padding:"6px 10px",fontSize:12,marginRight:8,background:m.paid?"#dc2626":"#16a34a",color:"#ffffff",border:"1px solid "+(m.paid?"#b91c1c":"#15803d")},onClick:()=>L(m.id),children:m.paid?"Mark Unpaid":"Mark Paid"})})]},m.id))})]})]})]})}function pt(){let s=null;try{s=sessionStorage.getItem("bakery_app_auth")||localStorage.getItem("bakery_app_auth")}catch{s=localStorage.getItem("bakery_app_auth")}if(!s)return e.jsx(ye,{to:"/login",replace:!0});const l=sessionStorage.getItem("bakery_user_role")||localStorage.getItem("bakery_user_role")||"admin",a=ve().pathname||window.location.pathname;return l!=="admin"&&!(l==="cashier"&&a.startsWith("/admin/cashier"))?e.jsxs("div",{style:{padding:24},children:[e.jsx("h2",{children:"Access denied"}),e.jsx("p",{children:"Please sign in as admin to continue."})]}):e.jsxs("div",{children:[e.jsx(We,{}),e.jsxs("div",{className:"layout",children:[e.jsx(Re,{}),e.jsx("main",{className:"content",children:e.jsx(Te,{})})]})]})}function xt(){return e.jsxs(Le,{children:[e.jsx(ne,{path:"/login",element:e.jsx(ct,{})}),e.jsx(ne,{path:"/",element:e.jsx(ye,{to:"/admin",replace:!0})}),e.jsx(ne,{path:"/cashier",element:e.jsx(Me,{})}),e.jsx(ne,{path:"/admin/cashier",element:e.jsx(Me,{})}),e.jsxs(ne,{path:"/admin/*",element:e.jsx(pt,{}),children:[e.jsx(ne,{index:!0,element:e.jsx(Fe,{})}),e.jsx(ne,{path:"sales",element:e.jsx(ze,{})}),e.jsx(ne,{path:"notifications",element:e.jsx(Ke,{})}),e.jsx(ne,{path:"inventory",element:e.jsx($e,{})}),e.jsx(ne,{path:"employees",element:e.jsx(qe,{})}),e.jsx(ne,{path:"profits",element:e.jsx(Je,{})}),e.jsx(ne,{path:"production",element:e.jsx(Ue,{})}),e.jsx(ne,{path:"expenses",element:e.jsx(Ve,{})}),e.jsx(ne,{path:"expenses/admin",element:e.jsx(dt,{})}),e.jsx(ne,{path:"expenses/inventory",element:e.jsx(mt,{})}),e.jsx(ne,{path:"payments/employees",element:e.jsx(ht,{})}),e.jsx(ne,{path:"payments/expenses",element:e.jsx(ut,{})}),e.jsx(ne,{path:"reports",element:e.jsx(He,{})}),e.jsx(ne,{path:"daily-summary",element:e.jsx(Ge,{})}),e.jsx(ne,{path:"summary/daily",element:e.jsx(Qe,{})}),e.jsx(ne,{path:"summary/weekly",element:e.jsx(st,{})}),e.jsx(ne,{path:"summary/monthly",element:e.jsx(rt,{})}),e.jsx(ne,{path:"users",element:e.jsx(lt,{})}),e.jsx(ne,{path:"products",element:e.jsx(it,{})}),e.jsx(ne,{path:"settings",element:e.jsx(ot,{})})]})]})}const yt=Ee([{path:"/*",element:e.jsx(xt,{}),errorElement:e.jsx("div",{style:{padding:20},children:"Unexpected Application Error! (route)"})}],{future:{v7_startTransition:!0,v7_relativeSplatPath:!0}});Oe(document.getElementById("root")).render(e.jsx(Be.StrictMode,{children:e.jsx(Pe,{router:yt})}));
